# OpenSAM í†µí•© ê°œë°œ ê°€ì´ë“œ

## ê°œìš”
OpenSAM í”„ë¡œì íŠ¸ë¥¼ ìœ„í•œ ì¢…í•© ê°œë°œ ê°€ì´ë“œì…ë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ëŠ” ì—¬ëŸ¬ ì „ëµ ê²Œì„ì„ ì§€ì›í•˜ëŠ” ë²”ìš© ê²Œì„ ì—”ì§„ì„ êµ¬ì¶•í•©ë‹ˆë‹¤.

**ì§€ì› ê²Œì„:**
1. **ì‚¼êµ­ì§€** - ì—­ì‚¬ ê¸°ë°˜ ì •ì¹˜ ì „ëµ ê²Œì„
2. **ì€í•˜ì˜ì›…ì „ì„¤** - SF ìš°ì£¼ ì „ëµ ê²Œì„
3. **ì¤‘ì„¸ íŒíƒ€ì§€** - íŒíƒ€ì§€ ì „ëµ ê²Œì„ (í–¥í›„)

**ê¸°ìˆ  ìŠ¤íƒ:**
- ë°±ì—”ë“œ: Node.js + TypeScript + MongoDB/Mongoose
- í”„ë¡ íŠ¸ì—”ë“œ: Next.js + TypeScript
- ë ˆê±°ì‹œ: PHP + Knex/SQL (ë§ˆì´ê·¸ë ˆì´ì…˜ ì¤‘)

**ì‘ì—… ê²½ë¡œ:** `/mnt/d/opensam/open-sam-backend/`

**ì‘ì—… ë°©ì¹¨:**
- âœ… **ììœ¨ì ìœ¼ë¡œ ì‘ì—… ìˆ˜í–‰**: í•œ í„´ë§Œ í•˜ê³  ë©ˆì¶”ì§€ ë§ ê²ƒ
- âœ… **ë‹¤ìŒ í•  ì¼ ìë™ íŒŒì•…**: ì‘ì—… ì™„ë£Œ í›„ ìŠ¤ìŠ¤ë¡œ ë‹¤ìŒ ì‘ì—… ì°¾ê¸°
- âœ… **ì—°ì† ì‹¤í–‰**: ì‚¬ìš©ìê°€ ë©ˆì¶”ë¼ê³  í•  ë•Œê¹Œì§€ ê³„ì† ì§„í–‰
- âœ… **ì§„í–‰ ìƒí™© ë³´ê³ **: ê° ë‹¨ê³„ë§ˆë‹¤ ë¬´ì—‡ì„ í–ˆëŠ”ì§€ ê°„ëµíˆ ë³´ê³ 
- âŒ **ë§¤ë²ˆ ë¬¼ì–´ë³´ì§€ ì•Šê¸°**: "ë‹¤ìŒì— Xë¥¼ í• ê¹Œìš”?" ê°™ì€ ì§ˆë¬¸ ê¸ˆì§€

**ì‘ì—… íë¦„ ì˜ˆì‹œ:**
```
1. TypeScript ì—ëŸ¬ 100ê°œ ìˆ˜ì • ì™„ë£Œ
   â†’ ë°”ë¡œ ë‹¤ìŒ 100ê°œ ìˆ˜ì • ì‹œì‘
   
2. í•¨ëŒ€ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ ì™„ì„±
   â†’ ë°”ë¡œ ì‘ì „ ê³„íš ì»´í¬ë„ŒíŠ¸ ì‘ì—… ì‹œì‘
   
3. 10ê°œ ì»¤ë§¨ë“œ JSON ë³€í™˜ ì™„ë£Œ
   â†’ ë°”ë¡œ ë‹¤ìŒ 10ê°œ ë³€í™˜ ì‹œì‘
```

---

## ğŸ“‹ ëª©ì°¨

1. [í”„ë¡œì íŠ¸ë³„ ì°¸ì¡° ê·œì¹™](#í”„ë¡œì íŠ¸ë³„-ì°¸ì¡°-ê·œì¹™)
2. [í•µì‹¬ ì„¤ê³„ ì›ì¹™](#í•µì‹¬-ì„¤ê³„-ì›ì¹™)
3. [ê²Œì„ ì‹œìŠ¤í…œ ë¬¸ì„œ](#ê²Œì„-ì‹œìŠ¤í…œ-ë¬¸ì„œ)
4. [ë°±ì—”ë“œ ì•„í‚¤í…ì²˜](#ë°±ì—”ë“œ-ì•„í‚¤í…ì²˜)
5. [TypeScript ë§ˆì´ê·¸ë ˆì´ì…˜](#typescript-ë§ˆì´ê·¸ë ˆì´ì…˜)
6. [ë²”ìš© ì—”ì§„ ê°œë°œ](#ë²”ìš©-ì—”ì§„-ê°œë°œ)
7. [í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ](#í”„ë¡ íŠ¸ì—”ë“œ-ê°œë°œ)
8. [ê°œë°œ ì›Œí¬í”Œë¡œìš°](#ê°œë°œ-ì›Œí¬í”Œë¡œìš°)

---

## í”„ë¡œì íŠ¸ë³„ ì°¸ì¡° ê·œì¹™

### ì‚¼êµ­ì§€ í”„ë¡œì íŠ¸

**ì°¸ì¡° ìš°ì„ ìˆœìœ„:**
1. **ì›¹ ê²€ìƒ‰ ìš°ì„ ** - ì—­ì‚¬ì  ì‚¬ì‹¤, ì¸ë¬¼ ì •ë³´, ê¸°ì¡´ ê²Œì„ ë©”ì¹´ë‹‰
2. **PHP ë ˆê±°ì‹œ ì½”ë“œ** - ê¸°ì¡´ êµ¬í˜„ íŒ¨í„´ ì°¸ì¡°
3. **ì¼ë°˜ ì§€ì‹** - ì—­ì‚¬ ë° ê²Œì„ ë””ìì¸ ì§€ì‹

**ê°€ì´ë“œë¼ì¸:**
```
âœ“ "ì›¹ ê²€ìƒ‰ ê²°ê³¼ì— ë”°ë¥´ë©´, ì¡°ì¡°ì˜ ì´ˆê¸° ëŠ¥ë ¥ì¹˜ëŠ”..."
âœ“ "PHP ë ˆê±°ì‹œ ì½”ë“œì—ì„œëŠ” ì´ë ‡ê²Œ êµ¬í˜„ë˜ì–´ ìˆìŠµë‹ˆë‹¤..."
âœ— "ì œ ìƒê°ì—ëŠ”..." (ì¶œì²˜ ì—†ì´)
```

### ì€í•˜ì˜ì›…ì „ì„¤ í”„ë¡œì íŠ¸

**ì°¸ì¡° ìš°ì„ ìˆœìœ„:**
1. **ì—…ë¡œë“œëœ ë§¤ë‰´ì–¼ ìµœìš°ì„ ** - ì¼ë³¸ì–´ ê²Œì„ ë§¤ë‰´ì–¼(éŠ€æ²³è‹±é›„ä¼èª¬â…¦)
2. **ì›ì‘ ì†Œì„¤ ì§€ì‹** - ë‹¤ë‚˜ì¹´ ìš”ì‹œí‚¤ ì†Œì„¤
3. **ì¶”ë¡ ** - ë¬¸ì„œ ë¶ˆëª…í™• ì‹œì—ë§Œ

**ê°€ì´ë“œë¼ì¸:**
```
âœ“ "ë§¤ë‰´ì–¼ 38í˜ì´ì§€ì— ë”°ë¥´ë©´..."
âœ“ "ì—…ë¡œë“œëœ ë¬¸ì„œì˜ ì‘ì „ê³„íš ì‹œìŠ¤í…œì—ì„œëŠ”..."
âœ— "ì•„ë§ˆë„..." (ë¬¸ì„œ í™•ì¸ ê°€ëŠ¥í•  ë•Œ)
```

**ì¤‘ìš”:** ë‹¤ìŒ í•­ëª©ì€ ë°˜ë“œì‹œ ë¬¸ì„œ í™•ì¸ í›„ ë‹µë³€
- ê²Œì„ ë©”ì¹´ë‹‰ê³¼ ì‹œìŠ¤í…œ
- êµ° ì¡°ì§ê³¼ ê³„ì¸µêµ¬ì¡°
- í•¨ëŒ€ í¸ì„±ê³¼ ìœ ë‹› íƒ€ì…
- ì „íˆ¬ ì‹œìŠ¤í…œ (ì „ëµ/ì „ìˆ )
- ìºë¦­í„° íŒŒë¼ë¯¸í„°ì™€ ì„±ì¥
- ì„¸ì…˜ ê´€ë¦¬ì™€ ìŠ¹ë¦¬ ì¡°ê±´

---

## í•µì‹¬ ì„¤ê³„ ì›ì¹™

### 1. ì„¸ê³„ ë…ë¦½ì  ì„¤ê³„ (World-Agnostic)

ì½”ë“œëŠ” **ì–´ë–¤ ì„¸ê³„ê´€**ì—ì„œë„ ì‘ë™í•´ì•¼ í•©ë‹ˆë‹¤.

```typescript
// âŒ ë‚˜ìœ ì˜ˆ: ì„¸ê³„ íŠ¹ì •
interface General {
  soldiers: number;
  horse: string;  // ì‚¼êµ­ì§€ ì „ìš©
}

// âœ… ì¢‹ì€ ì˜ˆ: ì„¸ê³„ ë…ë¦½ì 
interface ICommander {
  worldType: string;
  stats: Record<string, number>;
  specificData: Record<string, any>;  // ì„¸ê³„ë³„ ë°ì´í„° ê²©ë¦¬
}
```

### 2. ìŠ¤ì¼€ì¼ ë…ë¦½ì  ì„¤ê³„ (Scale-Agnostic)

ì½”ë“œëŠ” **ëª¨ë“  ê·œëª¨**ì—ì„œ ì‘ë™í•´ì•¼ í•©ë‹ˆë‹¤.

```typescript
// âŒ ë‚˜ìœ ì˜ˆ: ê³ ì • ìŠ¤ì¼€ì¼
const MAX_SOLDIERS = 20000;

// âœ… ì¢‹ì€ ì˜ˆ: ìŠ¤ì¼€ì¼ ë…ë¦½ì 
interface IMilitaryUnit {
  scaleLevel: number;       // 1~10
  actualCount: number;      // 5 ë˜ëŠ” 5,000,000
  unitTypeId: string;       // 'infantry' | 'battleship'
}
```

**ìŠ¤ì¼€ì¼ ë ˆë²¨ ì˜ˆì‹œ:**
- ë ˆë²¨ 1: ì†Œê·œëª¨ (5-50 ìœ ë‹›)
- ë ˆë²¨ 5: ì¤‘ê·œëª¨ êµ°ëŒ€ (1,000-10,000) â† ì‚¼êµ­ì§€ ê¸°ë³¸ê°’
- ë ˆë²¨ 10: ì€í•˜ í•¨ëŒ€ (ìˆ˜ë°±ë§Œ ìœ ë‹›)

### 3. ì„¤ì • ê¸°ë°˜ ì„¤ê³„ (Configuration-Driven)

ëª¨ë“  ê²Œì„ ë¡œì§ì€ JSON ì„¤ì •ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

```typescript
// âŒ ë‚˜ìœ ì˜ˆ: í•˜ë“œì½”ë”©
function calculateEffect() {
  return leadership * 0.6 + strength * 0.4;
}

// âœ… ì¢‹ì€ ì˜ˆ: JSON ì„¤ì •
// config/worlds/threekingdoms/actions.json
{
  "effects": [{
    "formula": "stats.leadership * 0.6 + stats.strength * 0.4"
  }]
}
```

### ì‘ì—… ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

ì½”ë“œ ì‘ì„± ì „ **ë°˜ë“œì‹œ í™•ì¸:**

- [ ] ë‹¤ë¥¸ ì„¸ê³„ê´€ì—ì„œë„ ì‘ë™í•˜ëŠ”ê°€?
- [ ] ìŠ¤ì¼€ì¼ì´ 1000ë°° ì¦ê°€í•´ë„ ì‘ë™í•˜ëŠ”ê°€?
- [ ] ì„¤ì • íŒŒì¼ë¡œ ì´ë™ ê°€ëŠ¥í•œê°€?
- [ ] ì„¸ê³„ë³„ ë°ì´í„°ê°€ `specificData`ì— ìˆëŠ”ê°€?
- [ ] í•¨ìˆ˜ê°€ `worldType` íŒŒë¼ë¯¸í„°ë¥¼ ë°›ëŠ”ê°€?

---

## ê²Œì„ ì‹œìŠ¤í…œ ë¬¸ì„œ

### ì€í•˜ì˜ì›…ì „ì„¤ - ì£¼ìš” ì‹œìŠ¤í…œ

#### 1. ì„¸ì…˜ ì‹œìŠ¤í…œ
- ì„¸ì…˜ë‹¹ ìµœëŒ€ 2000ëª…
- ì‹¤ì‹œê°„ ì§„í–‰: 1ì´ˆ = 24ì´ˆ (24ë°°ì†)
- ìŠ¹ë¦¬ ì¡°ê±´ ë‹¬ì„± ì‹œ ì¢…ë£Œ

#### 2. ì‹œê°„ íë¦„
```
ì‹¤ì‹œê°„ â†’ ê²Œì„ ì‹œê°„
1ì´ˆ â†’ 24ì´ˆ
60ì´ˆ â†’ 24ë¶„
60ë¶„ â†’ 24ì‹œê°„
24ì‹œê°„ â†’ 24ì¼
```

#### 3. ìºë¦­í„° íŒŒë¼ë¯¸í„°
- í†µì†” (çµ±ç‡): ì¸ì¬ í™œìš©, í•¨ëŒ€ ì‚¬ê¸°, ì§•ì„¸
- ì •ì¹˜ (æ”¿æ²»): ì •ì¹˜ì  ì˜í–¥ë ¥, ì‹œë¯¼ ì§€ì§€
- ìš´ì˜ (é‹å–¶): ì—…ë¬´ ê´€ë¦¬ ëŠ¥ë ¥
- ì •ë³´ (æƒ…å ±): ì •ë³´ ìˆ˜ì§‘ ë° ë¶„ì„
- ì§€íœ˜ (æŒ‡æ®): ë¶€ëŒ€ ì§€íœ˜ ë°˜ì‘ì†ë„
- ê¸°ë™ (æ©Ÿå‹•): í•¨ëŒ€ ê¸°ë™ì„±
- ê³µê²© (æ”»æ’ƒ): ê³µê²© ëŠ¥ë ¥
- ë°©ì–´ (é˜²å¾¡): ë°©ì–´ ëŠ¥ë ¥

#### 4. ê³„ê¸‰ ì‹œìŠ¤í…œ
**ì œêµ­êµ°:**
- ì›ìˆ˜ (5ëª…) â†’ ìƒê¸‰ëŒ€ì¥ (5ëª…) â†’ ëŒ€ì¥ (10ëª…) â†’ ì¤‘ì¥ (20ëª…) â†’ ì†Œì¥ (40ëª…) â†’ ì¤€ì¥ (80ëª…)

**ë™ë§¹êµ°:**
- ì›ìˆ˜ (5ëª…) â†’ ëŒ€ì¥ (10ëª…) â†’ ì¤‘ì¥ (20ëª…) â†’ ì†Œì¥ (40ëª…) â†’ ì¤€ì¥ (80ëª…)

#### 5. ì»¤ë§¨ë“œ ì‹œìŠ¤í…œ
**ì»¤ë§¨ë“œ ì¢…ë¥˜:**
- ê°œì¸ ì»¤ë§¨ë“œ: ì´ë™, ê°œì¸ í–‰ë™
- ì§€íœ˜ ì»¤ë§¨ë“œ: ì‘ì „ ê³„íš, í•¨ëŒ€ í¸ì„±
- ë³‘ì°¸ ì»¤ë§¨ë“œ: ë³´ê¸‰, ìˆ˜ë¦¬, ìœ ë‹› í• ë‹¹
- ì¸ì‚¬ ì»¤ë§¨ë“œ: ìŠ¹ì§„, ê°•ë“±, ì„ëª…
- ì •ì¹˜ ì»¤ë§¨ë“œ: êµ­ê°€ ì •ì±…, ê³¼ì„¸
- ì²©ë³´ ì»¤ë§¨ë“œ: ìˆ˜ì‚¬, ì²´í¬, ê°„ì²© í™œë™

**ì»¤ë§¨ë“œ í¬ì¸íŠ¸:**
- PCP (ì •ì¹˜): ì •ì¹˜/í–‰ì • í–‰ë™
- MCP (êµ°ì‚¬): êµ°ì‚¬ ì‘ì „
- íšŒë³µ: ê²Œì„ ì‹œê°„ 2ì‹œê°„ë§ˆë‹¤ (ì‹¤ì‹œê°„ 5ë¶„)

#### 6. í•¨ëŒ€ ë° ìœ ë‹›
**í•¨ëŒ€ ì¢…ë¥˜:**
- í•¨ëŒ€: ìµœëŒ€ 18,000ì²™
- ìˆ˜ì†¡í•¨ëŒ€: ìµœëŒ€ 6,900ì²™
- ìˆœì°°ëŒ€: ìµœëŒ€ 900ì²™
- ë…í–‰í•¨: ë‹¨ì¼ ê¸°í•¨

**í•¨ì„  ì¢…ë¥˜ (ì œêµ­êµ°):**
- ì „í•¨ (8 ë³€í˜•)
- ê³ ì†ì „í•¨ (8 ë³€í˜•)
- ìˆœí•­í•¨ (8 ë³€í˜•)
- êµ¬ì¶•í•¨ (8 ë³€í˜• + ì •ì°°í˜•)
- ì „íˆ¬ì •ëª¨í•¨ (4 ë³€í˜•)
- ë‡Œê²©ì •ëª¨í•¨ (4 ë³€í˜•, ì œêµ­ ì „ìš©)
- ê³µì‘í•¨ (4 ë³€í˜•)
- ìˆ˜ì†¡í•¨ (4 ë³€í˜•)
- ë³‘ì›ìˆ˜ì†¡í•¨ (4 ë³€í˜•)
- ì–‘ë¥™í•¨ (4 ë³€í˜•)

#### 7. ì‘ì „ ê³„íš
**ì‘ì „ ì¢…ë¥˜:**
- ì ë ¹ì‘ì „: ì  ì„±ê³„ ì ë ¹
- ë°©ìœ„ì‘ì „: ì„±ê³„ í†µì œ ìœ ì§€
- ì†Œíƒ•ì‘ì „: ë…í–‰í•¨ ì œê±°

**ê³„íš í”„ë¡œì„¸ìŠ¤:**
1. ì‘ì „ê³„íš ìˆ˜ë¦½
2. ë¶€ëŒ€ í• ë‹¹
3. ì‘ì „ ì‹¤í–‰
4. ê²°ê³¼ í‰ê°€ ë° ê³µì  ë¶€ì—¬

#### 8. ìŠ¹ë¦¬ ì¡°ê±´
- **ê²°ì •ì  ìŠ¹ë¦¬**: ì¸êµ¬ 90%+ í†µì œ, í•¨ì„  10:1 ìš°ì„¸
- **í•œì •ì  ìŠ¹ë¦¬**: ì  ìˆ˜ë„ ì ë ¹
- **êµ­ì§€ì  ìŠ¹ë¦¬**: ì‹œê°„ ì¢…ë£Œ ì‹œ ì¸êµ¬ ìš°ìœ„
- **íŒ¨ë°°**: ëª¨ë“  ì¡°ê±´ ë¯¸ë‹¬ì„±

### ì‚¼êµ­ì§€ - ì£¼ìš” ì‹œìŠ¤í…œ

#### ìºë¦­í„° ì‹œìŠ¤í…œ
- ì—­ì‚¬ì  ì¸ë¬¼ë“¤
- ëŠ¥ë ¥ì¹˜: ë¬´ë ¥, ì§€ë ¥, ì •ì¹˜, í†µì†”ë ¥, ë§¤ë ¥
- ê´€ê³„ë„ì™€ ì¶©ì„±ë„

#### ì˜í†  ê´€ë¦¬
- ë„ì‹œ í†µì œ ë° ê°œë°œ
- ìì› ìƒì‚°ê³¼ ê³¼ì„¸
- êµ°ì‚¬ ìœ ë‹› ì§•ë³‘

#### ì™¸êµ ì‹œìŠ¤í…œ
- ë™ë§¹ ë° ë°°ì‹ 
- í˜¼ì¸ ë™ë§¹
- ì¡°ê³µê³¼ ì¢…ì†

---

## ë°±ì—”ë“œ ì•„í‚¤í…ì²˜

### ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
src/
â”œâ”€â”€ engine/                    # âœ… ë²”ìš© ì—”ì§„ (ì™„ë£Œ)
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â””â”€â”€ Calculator.ts      # ìˆ˜ì‹ ê³„ì‚°ê¸°
â”‚   â”œâ”€â”€ systems/
â”‚   â”‚   â”œâ”€â”€ ModifierSystem.ts  # ìˆ˜ì •ì ì‹œìŠ¤í…œ
â”‚   â”‚   â””â”€â”€ ActionSystem.ts    # ì•¡ì…˜ ì‹œìŠ¤í…œ
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ index.ts           # ë²”ìš© ì¸í„°í˜ì´ìŠ¤
â”‚
â”œâ”€â”€ commands/                  # âš ï¸ ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”
â”‚   â”œâ”€â”€ general/               # ì‚¼êµ­ì§€ ì „ìš© â†’ JSON ë³€í™˜
â”‚   â””â”€â”€ nation/
â”‚
â”œâ”€â”€ models/                    # âš ï¸ ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”
â”‚   â”œâ”€â”€ general.model.ts       # â†’ ICommander
â”‚   â””â”€â”€ city.model.ts          # â†’ IStrategicLocation
â”‚
â”œâ”€â”€ repositories/              # âœ… ìƒì„± ì¤‘
â”‚   â”œâ”€â”€ base.repository.ts
â”‚   â”œâ”€â”€ general.repository.ts
â”‚   â””â”€â”€ city.repository.ts
â”‚
â”œâ”€â”€ adapters/                  # âœ… ìƒì„± ì¤‘
â”‚   â””â”€â”€ general.adapter.ts     # ë ˆê±°ì‹œ â†’ ë²”ìš© ì¸í„°í˜ì´ìŠ¤
â”‚
â””â”€â”€ const/                     # âš ï¸ ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš”
    â””â”€â”€ GameUnitConst.ts       # â†’ JSON

config/worlds/
â”œâ”€â”€ threekingdoms/             # âœ… ìƒì„±ë¨
â”‚   â”œâ”€â”€ world.json
â”‚   â”œâ”€â”€ stats.json
â”‚   â”œâ”€â”€ resources.json
â”‚   â”œâ”€â”€ unit-types.json
â”‚   â”œâ”€â”€ nation-types.json
â”‚   â””â”€â”€ actions.json
â””â”€â”€ galactic/                  # ğŸ”œ í–¥í›„
    â””â”€â”€ ...
```

### í•µì‹¬ ì¸í„°í˜ì´ìŠ¤

#### ICommander (ë²”ìš© ì§€íœ˜ê´€)
```typescript
interface ICommander {
  worldType: string;              // 'threekingdoms' | 'galactic'
  id: string;
  scaleLevel: number;             // 1-10
  stats: Record<string, number>;  // ëŠ¥ë ¥ì¹˜
  resources: Record<string, number>;
  specificData: Record<string, any>;  // ì„¸ê³„ë³„ ë°ì´í„°
  
  getStatValue(statName: string): number;
  getResourceValue(resourceName: string): number;
}
```

#### IStrategicLocation (ë²”ìš© ì „ëµ ê±°ì )
```typescript
interface IStrategicLocation {
  worldType: string;
  id: string;
  locationType: string;           // 'city' | 'planet' | 'fortress'
  scaleLevel: number;
  resources: Record<string, number>;
  specificData: Record<string, any>;
}
```

#### IMilitaryUnit (ë²”ìš© êµ°ì‚¬ ìœ ë‹›)
```typescript
interface IMilitaryUnit {
  scaleLevel: number;
  actualCount: number;
  unitTypeId: string;
  effectiveStrength: number;
  displayCount: string;           // "5K", "2.5M"
}
```

### Mongoose + TypeScript íŒ¨í„´

#### ëª¨ë¸ ì •ì˜
```typescript
import { Schema, model, Document, Types } from 'mongoose';

// ë°ì´í„° ì¸í„°í˜ì´ìŠ¤
export interface IGeneralData {
  nation: Types.ObjectId;
  name: string;
  gold: number;
  rice: number;
  leadership: number;
  strength: number;
  intelligence: number;
}

// ë¬¸ì„œ ì¸í„°í˜ì´ìŠ¤
export interface IGeneral extends Document {
  no: number;
  data: IGeneralData;
  var: Map<string, any>;
  createdAt: Date;
  updatedAt: Date;
}

// ìŠ¤í‚¤ë§ˆ
const generalSchema = new Schema<IGeneral>({
  no: { type: Number, required: true, unique: true },
  data: {
    nation: { type: Schema.Types.ObjectId, ref: 'Nation' },
    name: { type: String, required: true },
    gold: { type: Number, default: 0 },
    rice: { type: Number, default: 0 },
    leadership: { type: Number, default: 50 },
    strength: { type: Number, default: 50 },
    intelligence: { type: Number, default: 50 }
  },
  var: { type: Map, of: Schema.Types.Mixed }
}, { timestamps: true });

export const General = model<IGeneral>('General', generalSchema);
```

#### ë¦¬í¬ì§€í† ë¦¬ íŒ¨í„´
```typescript
import { FilterQuery, UpdateQuery } from 'mongoose';

export abstract class BaseRepository<T extends Document> {
  constructor(protected model: Model<T>) {}

  async findById(id: string): Promise<T | null> {
    return this.model.findById(id).exec();
  }

  async findMany(filter: FilterQuery<T>): Promise<T[]> {
    return this.model.find(filter).exec();
  }

  async updateById(id: string, update: UpdateQuery<T>): Promise<T | null> {
    return this.model.findByIdAndUpdate(id, update, { new: true }).exec();
  }

  async updateMany(
    filter: FilterQuery<T>,
    update: UpdateQuery<T>
  ): Promise<{ modifiedCount: number }> {
    const result = await this.model.updateMany(filter, update).exec();
    return { modifiedCount: result.modifiedCount };
  }

  async create(data: Partial<T>): Promise<T> {
    const doc = new this.model(data);
    return doc.save();
  }

  async deleteMany(filter: FilterQuery<T>): Promise<{ deletedCount: number }> {
    const result = await this.model.deleteMany(filter).exec();
    return { deletedCount: result.deletedCount };
  }
}

// ì‚¬ìš© ì˜ˆ
export class GeneralRepository extends BaseRepository<IGeneral> {
  constructor() {
    super(General);
  }

  async findByNation(nationId: string): Promise<IGeneral[]> {
    return this.findMany({ 'data.nation': nationId });
  }

  async updateGold(generalId: string, gold: number): Promise<IGeneral | null> {
    return this.updateById(generalId, { $set: { 'data.gold': gold } });
  }
}
```

---

## TypeScript ë§ˆì´ê·¸ë ˆì´ì…˜

### í˜„ì¬ ìƒíƒœ
- TypeScript ì—ëŸ¬: ~1,195ê°œ
- ë ˆê±°ì‹œ `db.table()` í˜¸ì¶œ: ë‹¤ìˆ˜
- ë§ˆì´ê·¸ë ˆì´ì…˜ ëª©í‘œ: íƒ€ì… ì•ˆì „ì„± í™•ë³´

### ìš°ì„ ìˆœìœ„ë³„ í•´ê²°

#### ìš°ì„ ìˆœìœ„ 1: ê¸°ì´ˆ íƒ€ì… ì •ì˜ (1ì£¼ì°¨)
```bash
# ì—ëŸ¬ ë¶„ì„
npx tsc --noEmit > type-errors.txt 2>&1
grep "error TS" type-errors.txt | wc -l
```

**í•´ì•¼ í•  ì¼:**
- [ ] ëª¨ë“  Mongoose ì¸í„°í˜ì´ìŠ¤ ì •ì˜
- [ ] BaseRepository ì œë„¤ë¦­ ìˆ˜ì •
- [ ] ëª¨ë“  ëª¨ë¸ì— ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„
- [ ] ë°°ëŸ´ íŒŒì¼(index.ts) ìƒì„±

#### ìš°ì„ ìˆœìœ„ 2: ë ˆê±°ì‹œ ì½”ë“œ ë³€í™˜ (2ì£¼ì°¨)
**ë ˆê±°ì‹œ db.table() â†’ ë¦¬í¬ì§€í† ë¦¬ ë³€í™˜:**

```typescript
// âŒ ë ˆê±°ì‹œ (Knex)
await db.table('general')
  .where('nation', nationId)
  .update({ gold: newGold });

// âœ… ë¦¬í¬ì§€í† ë¦¬
await generalRepository.updateMany(
  { 'data.nation': nationId },
  { $set: { 'data.gold': newGold } }
);
```

**ë³€í™˜ ë‹¨ê³„:**
1. í…Œì´ë¸”ëª… ì‹ë³„ â†’ ë¦¬í¬ì§€í† ë¦¬ ì°¾ê¸°
2. WHERE ì ˆ â†’ MongoDB í•„í„° ì¿¼ë¦¬
3. UPDATE/INSERT â†’ ë¦¬í¬ì§€í† ë¦¬ ë©”ì„œë“œ
4. ë°˜í™˜ ê°’ ì²˜ë¦¬ â†’ íƒ€ì… ì§€ì •

#### ìš°ì„ ìˆœìœ„ 3: íƒ€ì… ì—ëŸ¬ í•´ê²° (3ì£¼ì°¨)

**Null ì•ˆì •ì„± (~400ê°œ ì—ëŸ¬):**
```typescript
// âŒ ì—ëŸ¬
const gold = general.data.gold;

// âœ… ìˆ˜ì • 1: Null ì²´í¬
if (!general) throw new Error('Not found');
const gold = general.data.gold;

// âœ… ìˆ˜ì • 2: ì˜µì…”ë„ ì²´ì´ë‹
const gold = general?.data.gold ?? 0;
```

**íƒ€ì… ë¶ˆì¼ì¹˜ (~500ê°œ ì—ëŸ¬):**
```typescript
// âŒ ObjectId â†’ string
const id: string = general._id;

// âœ… ë³€í™˜
const id: string = general._id.toString();

// âŒ ì œë„¤ë¦­ ëˆ„ë½
const doc: Document = await Model.findById(id);

// âœ… ì œë„¤ë¦­ ëª…ì‹œ
const doc: IGeneral | null = await Model.findById(id);
```

**Request íƒ€ì… í™•ì¥ (~200ê°œ ì—ëŸ¬):**
```typescript
import { Request } from 'express';

export interface AuthRequest extends Request {
  user?: {
    id: string;
    nationNo: number;
  };
  general?: IGeneral;
}

// ì‚¬ìš©
app.get('/api/general', (req: AuthRequest, res) => {
  const general = req.general;  // âœ… íƒ€ì… ì•ˆì „
});
```

### ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

#### 1ì£¼ì°¨: ê¸°ì´ˆ
- [ ] Mongoose ì¸í„°í˜ì´ìŠ¤ ì •ì˜ (`models/types/`)
- [ ] BaseRepository ìƒì„±
- [ ] ëª¨ë“  ëª¨ë¸ ë¦¬í¬ì§€í† ë¦¬ êµ¬í˜„
- [ ] ë°°ëŸ´ íŒŒì¼ ìƒì„±

#### 2ì£¼ì°¨: ë³€í™˜
- [ ] `db.table()` í˜¸ì¶œ ìˆ˜ íŒŒì•…: `grep -r "db.table" src/ | wc -l`
- [ ] ì˜í–¥ë„ ë†’ì€ íŒŒì¼ ì‹ë³„
- [ ] íŒŒì¼ë³„ ë³€í™˜ (í•˜ë£¨ 50ê°œ)
- [ ] ë³€í™˜ í›„ í…ŒìŠ¤íŠ¸

#### 3ì£¼ì°¨: íƒ€ì… í•´ê²°
- [ ] Null ì•ˆì •ì„± ì—ëŸ¬ ìˆ˜ì •
- [ ] íƒ€ì… ë¶ˆì¼ì¹˜ ìˆ˜ì •
- [ ] Request íƒ€ì… í™•ì¥

#### 4ì£¼ì°¨: ì •ë¦¬
- [ ] ë¹Œë“œ ì„±ê³µ: `npm run build`
- [ ] TypeScript ì—ëŸ¬ 0ê°œ
- [ ] `as any` ì œê±°
- [ ] í…ŒìŠ¤íŠ¸ í†µê³¼

### ì§„í–‰ ì¶”ì 
```bash
# ì¼ì¼ ì§„í–‰ ì¶”ì 
echo "$(date): $(grep -c 'error TS' errors.txt) errors" >> progress.log

# ì§„í–‰ ìƒí™© ë³´ê¸°
cat progress.log
```

---

## ë²”ìš© ì—”ì§„ ê°œë°œ

### JSON ì•¡ì…˜ ì •ì˜

#### í…œí”Œë¦¿
```json
{
  "action_id": {
    "id": "action_id",
    "name": "ì•¡ì…˜ í‘œì‹œëª…",
    "description": "ì•¡ì…˜ ì„¤ëª…",
    "category": "domestic|military|diplomatic",
    "requirements": {
      "location_type": "city|battlefield",
      "min_population": 1000,
      "required_stats": {
        "leadership": 50
      }
    },
    "costs": {
      "gold": 100,
      "rice": 50,
      "turns": 1
    },
    "effects": [
      {
        "target": "location.agriculture",
        "formula": "stats.politics * 0.7 + stats.leadership * 0.3",
        "min": 1,
        "max": 100
      }
    ],
    "experience_gain": [
      { "stat": "politics", "amount": 2 },
      { "stat": "leadership", "amount": 1 }
    ],
    "successRate": {
      "base": 0.8,
      "formula": "0.8 + (stats.politics / 200)"
    },
    "cooldown": 0,
    "repeatable": true
  }
}
```

### TypeScript ì»¤ë§¨ë“œ â†’ JSON ë³€í™˜

#### BEFORE (TypeScript):
```typescript
export async function agriculture(general: General, city: City) {
  // ìš”êµ¬ì‚¬í•­
  if (city.population < 1000) throw new Error('ì¸êµ¬ ë¶€ì¡±');
  if (general.politics < 30) throw new Error('ì •ì¹˜ë ¥ ë¶€ì¡±');
  
  // ë¹„ìš©
  general.gold -= 100;
  city.rice -= 50;
  general.turn--;
  
  // íš¨ê³¼
  const effect = general.politics * 0.7 + general.leadership * 0.3;
  city.agriculture += effect;
  
  // ê²½í—˜ì¹˜
  general.politics++;
  general.leadership++;
}
```

#### AFTER (JSON):
```json
{
  "agriculture": {
    "id": "agriculture",
    "name": "ë†ì—… ê°œë°œ",
    "category": "domestic",
    "requirements": {
      "location_type": "city",
      "min_population": 1000,
      "required_stats": {
        "politics": 30
      }
    },
    "costs": {
      "gold": 100,
      "rice": 50,
      "turns": 1
    },
    "effects": [
      {
        "target": "location.agriculture",
        "formula": "stats.politics * 0.7 + stats.leadership * 0.3"
      }
    ],
    "experience_gain": [
      { "stat": "politics", "amount": 1 },
      { "stat": "leadership", "amount": 1 }
    ]
  }
}
```

### ì–´ëŒ‘í„° íŒ¨í„´

ë ˆê±°ì‹œ ëª¨ë¸ì„ ë²”ìš© ì¸í„°í˜ì´ìŠ¤ë¡œ ë˜í•‘:

```typescript
export class GeneralAdapter implements ICommander {
  constructor(private general: General) {}

  get worldType(): string {
    return 'threekingdoms';
  }

  get stats(): Record<string, number> {
    return {
      leadership: this.general.leadership || 0,
      strength: this.general.strength || 0,
      intelligence: this.general.intelligence || 0,
      politics: this.general.politics || 0
    };
  }

  get resources(): Record<string, number> {
    return {
      gold: this.general.gold || 0,
      rice: this.general.rice || 0
    };
  }

  get specificData(): Record<string, any> {
    return {
      horse: this.general.horse,
      weapon: this.general.weapon,
      // ëª¨ë“  ì‚¼êµ­ì§€ ì „ìš© ë°ì´í„°
    };
  }

  getStatValue(statName: string): number {
    return this.stats[statName] ?? 0;
  }
}

// ì‚¬ìš©
const general = await General.findById(id);
const commander: ICommander = new GeneralAdapter(general);
await ActionSystem.execute('agriculture', commander, city);
```

---

## í”„ë¡ íŠ¸ì—”ë“œ ê°œë°œ

### í˜„ì¬ ìƒíƒœ

**ê¸°ì¡´ í”„ë¡ íŠ¸ì—”ë“œ:**
- ì‚¼êµ­ì§€ ë ˆê±°ì‹œ PHP í”„ë¡ íŠ¸ì—”ë“œ
- ë¶€ë¶„ ë§ˆì´ê·¸ë ˆì´ì…˜ëœ Next.js ì‚¼êµ­ì§€ í”„ë¡ íŠ¸ì—”ë“œ

**ì‹ ê·œ ê°œë°œ í•„ìš”:**
- ì€í•˜ì˜ì›…ì „ì„¤ í”„ë¡ íŠ¸ì—”ë“œ (ì²˜ìŒë¶€í„° êµ¬ì¶•)

### í”„ë¡œì íŠ¸ êµ¬ì¡°

```
opensam-frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ (auth)/              # ì¸ì¦
â”‚   â”‚   â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â”‚   â””â”€â”€ register/
â”‚   â”‚   â””â”€â”€ (games)/
â”‚   â”‚       â”œâ”€â”€ threekingdoms/   # ì‚¼êµ­ì§€ (ê¸°ì¡´)
â”‚   â”‚       â””â”€â”€ logh/            # ì€í•˜ì˜ì›…ì „ì„¤ (ì‹ ê·œ)
â”‚   â”‚           â”œâ”€â”€ page.tsx     # ë©”ì¸ ëŒ€ì‹œë³´ë“œ
â”‚   â”‚           â”œâ”€â”€ character/   # ìºë¦­í„° ê´€ë¦¬
â”‚   â”‚           â”œâ”€â”€ fleet/       # í•¨ëŒ€ ê´€ë¦¬
â”‚   â”‚           â”œâ”€â”€ operation/   # ì‘ì „ ê³„íš
â”‚   â”‚           â”œâ”€â”€ battle/      # ì „ìˆ  ì „íˆ¬
â”‚   â”‚           â”œâ”€â”€ politics/    # ì •ì¹˜ ì‹œìŠ¤í…œ
â”‚   â”‚           â”œâ”€â”€ logistics/   # ë³‘ì°¸ ê´€ë¦¬
â”‚   â”‚           â””â”€â”€ map/         # ìš°ì£¼ ì§€ë„
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ common/              # ê³µí†µ
â”‚   â”‚   â”œâ”€â”€ threekingdoms/
â”‚   â”‚   â””â”€â”€ logh/                # ì€í•˜ì˜ì›…ì „ì„¤ ì „ìš©
â”‚   â”‚       â”œâ”€â”€ character/
â”‚   â”‚       â”œâ”€â”€ fleet/
â”‚   â”‚       â”œâ”€â”€ operation/
â”‚   â”‚       â”œâ”€â”€ battle/
â”‚   â”‚       â”œâ”€â”€ map/
â”‚   â”‚       â”œâ”€â”€ ui/
â”‚   â”‚       â””â”€â”€ layout/
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/
â”‚   â”‚   â”œâ”€â”€ api/logh/            # API í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ hooks/logh/          # React í›…
â”‚   â”‚   â”œâ”€â”€ store/logh/          # Zustand ìŠ¤í† ì–´
â”‚   â”‚   â”œâ”€â”€ types/logh/          # TypeScript íƒ€ì…
â”‚   â”‚   â””â”€â”€ utils/logh/          # ìœ í‹¸ë¦¬í‹°
â”‚   â”‚
â”‚   â””â”€â”€ styles/
â”‚       â””â”€â”€ logh/                # í…Œë§ˆ CSS
â”‚
â””â”€â”€ public/images/logh/          # ì´ë¯¸ì§€ ë¦¬ì†ŒìŠ¤
```

### ê¸°ìˆ  ìŠ¤íƒ

```typescript
// package.json
{
  "dependencies": {
    "next": "14.x",
    "react": "18.x",
    "typescript": "5.x",
    "zustand": "^4.x",               // ìƒíƒœ ê´€ë¦¬
    "@tanstack/react-query": "^5.x", // ì„œë²„ ìƒíƒœ
    "socket.io-client": "^4.x",      // ì‹¤ì‹œê°„ í†µì‹ 
    "tailwindcss": "^3.x"            // ìŠ¤íƒ€ì¼ë§
  }
}
```

### í•µì‹¬ íƒ€ì… ì •ì˜

```typescript
// src/lib/types/logh/character.ts
export interface Character {
  id: string;
  no: number;
  name: string;
  type: 'original' | 'generated';
  faction: 'empire' | 'alliance';
  
  // 8ê°€ì§€ íŒŒë¼ë¯¸í„° (ë§¤ë‰´ì–¼ ê¸°ë°˜)
  stats: {
    leadership: number;      // í†µì†”
    politics: number;        // ì •ì¹˜
    administration: number;  // ìš´ì˜
    intelligence: number;    // ì •ë³´
    command: number;         // ì§€íœ˜
    mobility: number;        // ê¸°ë™
    attack: number;          // ê³µê²©
    defense: number;         // ë°©ì–´
  };
  
  rank: Rank;
  position: Position;
  commandPoints: {
    pcp: { current: number; max: number };
    mcp: { current: number; max: number };
    nextRecover: Date;
  };
  
  fleets: string[];
  location: GridCoordinate;
}

// src/lib/types/logh/fleet.ts
export interface Fleet {
  id: string;
  name: string;
  type: 'fleet' | 'transport' | 'patrol' | 'independent';
  commander: string;
  
  maxShips: number;  // 18,000 | 6,900 | 900 | 1
  composition: {
    battleship_i: number;
    battleship_ii: number;
    fast_battleship_i: number;
    // ... ëª¨ë“  í•¨ì„  íƒ€ì…
  };
  groundForces: {
    armored_grenadiers: number;
    armored_infantry: number;
    light_infantry: number;
    fleet_crew: number;
  };
  
  location: GridCoordinate;
  fuel: number;
  morale: number;
  status: 'idle' | 'moving' | 'operation' | 'battle';
}

// src/lib/types/logh/operation.ts
export interface Operation {
  id: string;
  type: 'conquest' | 'defense' | 'sweep';
  name: string;
  planner: string;
  
  target: GridCoordinate;
  targetSystems: string[];
  assignedFleets: string[];
  
  status: 'planning' | 'ordered' | 'active' | 'completed';
  progress: number;
  meritPoints: number;
  successRate: number;
}
```

### ìƒíƒœ ê´€ë¦¬ (Zustand)

```typescript
// src/lib/store/logh/gameStore.ts
import { create } from 'zustand';

interface GameState {
  // ê²Œì„ ì‹œê°„ (24ë°°ì†)
  gameTime: Date;
  realTime: Date;
  timeSpeed: number;
  
  // ì„¸ì…˜
  sessionId: string;
  maxPlayers: number;
  currentPlayers: number;
  
  // í”Œë ˆì´ì–´
  playerId: string;
  characterId: string;
  faction: 'empire' | 'alliance';
  
  // UI
  selectedFleet?: string;
  selectedOperation?: string;
  selectedGrid?: GridCoordinate;
  notifications: Notification[];
  
  // Actions
  updateGameTime: (gameTime: Date, realTime: Date) => void;
  selectFleet: (fleetId: string) => void;
  addNotification: (notification: Notification) => void;
}

export const useGameStore = create<GameState>((set) => ({
  gameTime: new Date(),
  realTime: new Date(),
  timeSpeed: 24,
  
  sessionId: '',
  maxPlayers: 2000,
  currentPlayers: 0,
  
  playerId: '',
  characterId: '',
  faction: 'empire',
  
  notifications: [],
  
  updateGameTime: (gameTime, realTime) => set({ gameTime, realTime }),
  selectFleet: (fleetId) => set({ selectedFleet: fleetId }),
  addNotification: (notification) => 
    set((state) => ({ 
      notifications: [...state.notifications, notification] 
    }))
}));

// src/lib/store/logh/fleetStore.ts
interface FleetState {
  fleets: Record<string, Fleet>;
  loading: boolean;
  
  setFleets: (fleets: Fleet[]) => void;
  updateFleet: (fleetId: string, updates: Partial<Fleet>) => void;
  moveFleet: (fleetId: string, destination: GridCoordinate) => void;
}

export const useFleetStore = create<FleetState>((set) => ({
  fleets: {},
  loading: false,
  
  setFleets: (fleets) => 
    set({ 
      fleets: fleets.reduce((acc, f) => ({ ...acc, [f.id]: f }), {}) 
    }),
  
  updateFleet: (fleetId, updates) =>
    set((state) => ({
      fleets: {
        ...state.fleets,
        [fleetId]: { ...state.fleets[fleetId], ...updates }
      }
    })),
  
  moveFleet: async (fleetId, destination) => {
    // API í˜¸ì¶œ
    set((state) => ({
      fleets: {
        ...state.fleets,
        [fleetId]: { 
          ...state.fleets[fleetId], 
          destination,
          status: 'moving'
        }
      }
    }));
  }
}));
```

### React Query í›…

```typescript
// src/lib/hooks/logh/useCharacter.ts
import { useQuery, useMutation, useQueryClient } from '@tanstack/react-query';

export function useCharacter(characterId: string) {
  return useQuery({
    queryKey: ['character', characterId],
    queryFn: () => api.getCharacter(characterId),
    staleTime: 30000,
  });
}

export function useUpdateStats() {
  const queryClient = useQueryClient();
  
  return useMutation({
    mutationFn: ({ characterId, stat, amount }) => 
      api.updateStat(characterId, stat, amount),
    onSuccess: (data, variables) => {
      queryClient.invalidateQueries({ 
        queryKey: ['character', variables.characterId] 
      });
    }
  });
}

// src/lib/hooks/logh/useFleet.ts
export function useFleets(characterId: string) {
  return useQuery({
    queryKey: ['fleets', characterId],
    queryFn: () => api.getFleets(characterId),
    staleTime: 10000,  // ì‹¤ì‹œê°„ì„± ì¤‘ìš”
  });
}

// src/lib/hooks/logh/useGameTime.ts
export function useGameTime() {
  const { gameTime, realTime, updateGameTime } = useGameStore();
  
  useEffect(() => {
    const interval = setInterval(() => {
      const now = new Date();
      const elapsed = now.getTime() - realTime.getTime();
      const gameElapsed = elapsed * 24;  // 24ë°°ì†
      
      const newGameTime = new Date(gameTime.getTime() + gameElapsed);
      updateGameTime(newGameTime, now);
    }, 1000);
    
    return () => clearInterval(interval);
  }, [gameTime, realTime]);
  
  return { gameTime, realTime };
}
```

### ì‹¤ì‹œê°„ í†µì‹  (Socket.io)

```typescript
// src/lib/hooks/logh/useRealtime.ts
import { useEffect } from 'react';
import { io, Socket } from 'socket.io-client';

let socket: Socket | null = null;

export function useRealtime() {
  const { sessionId, characterId, addNotification } = useGameStore();
  const { updateFleet } = useFleetStore();
  
  useEffect(() => {
    if (!sessionId || !characterId) return;
    
    socket = io(process.env.NEXT_PUBLIC_SOCKET_URL!, {
      query: { sessionId, characterId }
    });
    
    // ê²Œì„ ì‹œê°„ ì—…ë°ì´íŠ¸
    socket.on('time:update', (data) => {
      useGameStore.getState().updateGameTime(
        new Date(data.gameTime),
        new Date(data.realTime)
      );
    });
    
    // í•¨ëŒ€ ì´ë™
    socket.on('fleet:moved', (data) => {
      updateFleet(data.fleetId, { location: data.location });
    });
    
    // ì „íˆ¬ ì‹œì‘
    socket.on('battle:started', (data) => {
      addNotification({
        type: 'battle',
        message: 'ì „íˆ¬ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!',
        battleId: data.battleId
      });
    });
    
    // ì‘ì „ ì™„ë£Œ
    socket.on('operation:completed', (data) => {
      addNotification({
        type: 'operation',
        message: `ì‘ì „ ì™„ë£Œ! ê³µì  +${data.meritPoints}`,
        operationId: data.operationId
      });
    });
    
    return () => {
      socket?.disconnect();
      socket = null;
    };
  }, [sessionId, characterId]);
  
  return {
    emitMoveFleet: (fleetId: string, destination: GridCoordinate) => {
      socket?.emit('fleet:move', { fleetId, destination });
    },
    emitBattleCommand: (battleId: string, command: BattleCommand) => {
      socket?.emit('battle:command', { battleId, command });
    }
  };
}
```

### ì£¼ìš” ì»´í¬ë„ŒíŠ¸

#### CharacterCard
```typescript
// src/components/logh/character/CharacterCard.tsx
'use client';

export function CharacterCard({ character }: { character: Character }) {
  return (
    <div className="logh-command-card">
      {/* í—¤ë” */}
      <div className="flex items-start justify-between mb-4">
        <div>
          <h3 className="text-xl font-bold">{character.name}</h3>
          <p className="text-sm text-gray-400">{character.position.name}</p>
        </div>
        <RankBadge rank={character.rank} faction={character.faction} />
      </div>
      
      {/* ì»¤ë§¨ë“œ í¬ì¸íŠ¸ */}
      <div className="grid grid-cols-2 gap-4 mb-4">
        <CommandPointBar
          label="PCP"
          current={character.commandPoints.pcp.current}
          max={character.commandPoints.pcp.max}
          color="blue"
        />
        <CommandPointBar
          label="MCP"
          current={character.commandPoints.mcp.current}
          max={character.commandPoints.mcp.max}
          color="red"
        />
      </div>
      
      {/* ëŠ¥ë ¥ì¹˜ */}
      <StatsDisplay stats={character.stats} compact />
    </div>
  );
}
```

#### FleetCard
```typescript
// src/components/logh/fleet/FleetCard.tsx
export function FleetCard({ fleet }: { fleet: Fleet }) {
  const totalShips = Object.values(fleet.composition).reduce((a, b) => a + b, 0);
  
  return (
    <div className="logh-command-card">
      <div className="flex items-start gap-4">
        <div className="logh-fleet-icon">
          {fleet.type === 'fleet' ? 'F' : 'T'}
        </div>
        
        <div className="flex-1">
          <h4 className="text-lg font-bold">{fleet.name}</h4>
          <p className="text-sm text-gray-400">ì‚¬ë ¹ê´€: {fleet.commander}</p>
          
          <div className="flex items-center gap-4 text-sm mt-2">
            <div>ì²™ìˆ˜: {totalShips.toLocaleString()}</div>
            <div>í•­ì†: {fleet.fuel}</div>
            <div>ì‚¬ê¸°: {fleet.morale}%</div>
          </div>
          
          <StatusBadge status={fleet.status} />
        </div>
      </div>
    </div>
  );
}
```

### í…Œë§ˆ ë° ìŠ¤íƒ€ì¼

```css
/* src/styles/logh/theme.css */
:root {
  /* ì œêµ­ í…Œë§ˆ */
  --logh-empire-primary: #1a1a2e;
  --logh-empire-accent: #e94560;
  --logh-empire-gold: #f4a261;
  
  /* ë™ë§¹ í…Œë§ˆ */
  --logh-alliance-primary: #0f3460;
  --logh-alliance-accent: #00b4d8;
  --logh-alliance-gold: #90e0ef;
  
  /* ê³µí†µ */
  --logh-text-primary: #e8e8e8;
  --logh-background: #0a0e27;
}

/* ìš°ì£¼ ë°°ê²½ */
.logh-space-background {
  background: radial-gradient(ellipse at center, #0a0e27 0%, #000 100%);
}

/* ì»¤ë§¨ë“œ ì¹´ë“œ */
.logh-command-card {
  background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
  border: 1px solid #2d3748;
  border-radius: 8px;
  padding: 16px;
  transition: all 0.3s ease;
}

.logh-command-card:hover {
  border-color: var(--logh-empire-accent);
  box-shadow: 0 6px 12px rgba(233, 69, 96, 0.2);
  transform: translateY(-2px);
}

/* í•¨ëŒ€ ì•„ì´ì½˜ */
.logh-fleet-icon {
  display: inline-flex;
  width: 40px;
  height: 40px;
  background: radial-gradient(circle, #e94560 0%, #1a1a2e 100%);
  border: 2px solid var(--logh-empire-gold);
  border-radius: 50%;
  align-items: center;
  justify-content: center;
  font-weight: bold;
}
```

### í•µì‹¬ í™”ë©´ êµ¬ì„±

#### 1. ë©”ì¸ ëŒ€ì‹œë³´ë“œ
```
+--------------------------------------------------+
| ì„¸ì…˜ ì •ë³´    ê²Œì„ì‹œê°„: 798ë…„ 2ì›” 15ì¼ 14:23     |
+--------------------------------------------------+
| ìºë¦­í„° ì •ë³´         | ì»¤ë§¨ë“œ í¬ì¸íŠ¸              |
| ë¼ì¸í•˜ë¥´íŠ¸          | PCP: 320/640               |
| ì œêµ­ ì›ìˆ˜           | MCP: 480/640               |
| í†µì†”95 ì •ì¹˜82 ìš´ì˜88|                            |
+--------------------------------------------------+
| í•¨ëŒ€ í˜„í™©                                        |
| ì œ1í•¨ëŒ€ (18,000ì²™) - ì‘ì „ì¤‘                     |
| ì œ7í•¨ëŒ€ (15,200ì²™) - ëŒ€ê¸°ì¤‘                     |
+--------------------------------------------------+
```

#### 2. í•¨ëŒ€ ê´€ë¦¬
```
+--------------------------------------------------+
| í•¨ëŒ€ ëª©ë¡           | í•¨ëŒ€ ìƒì„¸                  |
| ì œ1í•¨ëŒ€             | ì‚¬ë ¹ê´€: ë¼ì¸í•˜ë¥´íŠ¸         |
| 18,000ì²™            | ìœ„ì¹˜: ì´ì œë¥´ë¡  ìš”ìƒˆ        |
| ì‘ì „ì¤‘              | í•­ì†: 850/1000             |
|                     | ì‚¬ê¸°: 95%                  |
|                     | í•¨ì„  êµ¬ì„±:                 |
|                     | ì „í•¨ I: 3,200ì²™            |
|                     | ìˆœì–‘í•¨ III: 4,500ì²™        |
+--------------------------------------------------+
```

#### 3. ì‘ì „ ê³„íš
```
+--------------------------------------------------+
| ì‘ì „ ëª©ë¡           | ì‘ì „ ìƒì„¸                  |
| [#124] ì ë ¹ì‘ì „     | ì‘ì „ëª…: í˜ì” íšŒë‘ ì ë ¹     |
| í˜ì” íšŒë‘           | ì¢…ë¥˜: ì ë ¹ì‘ì „             |
| ì§„í–‰ì¤‘ 65%          | í• ë‹¹ í•¨ëŒ€:                 |
|                     | - ì œ1í•¨ëŒ€ (18,000ì²™)       |
|                     | - ì œ7í•¨ëŒ€ (15,200ì²™)       |
|                     | ì˜ˆìƒ ê³µì : 800-1200        |
+--------------------------------------------------+
```

#### 4. ì „ìˆ  ì „íˆ¬
```
+--------------------------------------------------+
|           ì „íˆ¬ ì§€ë„                              |
| [ì•„êµ°]              [ì êµ°]                       |
| ì œ1í•¨ëŒ€ â–ˆâ–ˆâ–ˆâ–ˆ        â–ˆâ–ˆâ–ˆâ–ˆ ì í•¨ëŒ€                 |
| 18,000ì²™            12,500ì²™                     |
| ì‚¬ê¸° 92%            ì‚¬ê¸° 68%                     |
+--------------------------------------------------+
| [ì´ë™] [ì„ íšŒ] [ê³µê²©ëª…ë ¹] [í‡´ê°ëª…ë ¹]             |
+--------------------------------------------------+
```

#### 5. ìš°ì£¼ ì§€ë„
```
+--------------------------------------------------+
|        ì œêµ­ ì˜ì—­                                 |
|  â–‘â–‘â–‘[ì˜¤ë”˜]â–‘â–‘â–‘[ì´ì œë¥´ë¡ ]â–‘â–‘â–‘                     |
|        [í˜ì” íšŒë‘]                               |
|        ë™ë§¹ ì˜ì—­                                 |
|  â–“â–“â–“[í•˜ì´ë„¤ì„¼]â–“â–“â–“â–“â–“â–“â–“                          |
+--------------------------------------------------+
| ì„ íƒ: í˜ì” íšŒë‘ (125, 78)                       |
| í•¨ëŒ€: ì œ1í•¨ëŒ€ (ì•„êµ°), ë™ë§¹ ì œ5í•¨ëŒ€ (ì )         |
+--------------------------------------------------+
```

### ê°œë°œ ë¡œë“œë§µ

#### Phase 1: ê¸°ì´ˆ (1ì£¼)
- [ ] Next.js í”„ë¡œì íŠ¸ ìƒì„±
- [ ] ë””ë ‰í† ë¦¬ êµ¬ì¡° ì„¤ì •
- [ ] Tailwind + í…Œë§ˆ
- [ ] íƒ€ì… ì •ì˜

#### Phase 2: ìºë¦­í„° (1-2ì£¼)
- [ ] ë¡œê·¸ì¸/íšŒì›ê°€ì…
- [ ] ìºë¦­í„° ìƒì„±/ì„ íƒ
- [ ] ìºë¦­í„° ì¹´ë“œ
- [ ] ëŠ¥ë ¥ì¹˜ í‘œì‹œ

#### Phase 3: ëŒ€ì‹œë³´ë“œ (2ì£¼)
- [ ] ê²Œì„ ì‹œê°„ ì‹œìŠ¤í…œ
- [ ] ì»¤ë§¨ë“œ í¬ì¸íŠ¸
- [ ] í•¨ëŒ€ í˜„í™© ìš”ì•½
- [ ] ì´ë²¤íŠ¸ ë¡œê·¸

#### Phase 4: í•¨ëŒ€ ê´€ë¦¬ (2-3ì£¼)
- [ ] í•¨ëŒ€ ëª©ë¡
- [ ] í•¨ëŒ€ ìƒì„¸ ì •ë³´
- [ ] í•¨ì„  êµ¬ì„±
- [ ] í•¨ëŒ€ ì¬í¸ì„±
- [ ] í•¨ëŒ€ ì´ë™

#### Phase 5: ìš°ì£¼ ì§€ë„ (2-3ì£¼)
- [ ] ê·¸ë¦¬ë“œ ì‹œìŠ¤í…œ
- [ ] ì€í•˜ ì§€ë„
- [ ] í•¨ëŒ€ ìœ„ì¹˜ ì¶”ì 
- [ ] ì›Œí”„ ê²½ë¡œ

#### Phase 6: ì‘ì „ ê³„íš (2ì£¼)
- [ ] ì‘ì „ ëª©ë¡
- [ ] ì‘ì „ ê³„íš ìƒì„±
- [ ] í•¨ëŒ€ í• ë‹¹
- [ ] ì§„í–‰ ëª¨ë‹ˆí„°ë§

#### Phase 7: ì „ìˆ  ì „íˆ¬ (3-4ì£¼)
- [ ] ì „íˆ¬ ì§€ë„
- [ ] ìœ ë‹› ì´ë™
- [ ] ì „íˆ¬ ì»¤ë§¨ë“œ
- [ ] ì§„í˜• ë³€ê²½

#### Phase 8: ë³‘ì°¸ (1-2ì£¼)
- [ ] ìƒì‚° í˜„í™©
- [ ] ì°½ê³  ê´€ë¦¬
- [ ] ìì› í• ë‹¹

#### Phase 9: ì •ì¹˜ (1-2ì£¼)
- [ ] ì¸ì‚¬ ì‹œìŠ¤í…œ
- [ ] ìŠ¹ì§„/ê°•ë“±
- [ ] ì§ìœ„ ì„ëª…

#### Phase 10: ì‹¤ì‹œê°„ (2ì£¼)
- [ ] Socket.io ì—°ê²°
- [ ] ì‹œê°„ ë™ê¸°í™”
- [ ] ìƒíƒœ ë™ê¸°í™”
- [ ] ì´ë²¤íŠ¸ ì•Œë¦¼

#### Phase 11: ìµœì í™” (2-3ì£¼)
- [ ] ì„±ëŠ¥ ìµœì í™”
- [ ] ë©”ëª¨ë¦¬ ê´€ë¦¬
- [ ] ëª¨ë°”ì¼ ë°˜ì‘í˜•
- [ ] í…ŒìŠ¤íŠ¸

**ì´ ì˜ˆìƒ: 18-25ì£¼ (4-6ê°œì›”)**

### ì¦‰ì‹œ ì‹œì‘

```bash
# í”„ë¡œì íŠ¸ ìƒì„±
npx create-next-app@latest opensam-frontend --typescript --tailwind --app

# íŒ¨í‚¤ì§€ ì„¤ì¹˜
cd opensam-frontend
npm install zustand @tanstack/react-query socket.io-client

# ê°œë°œ ì„œë²„
npm run dev
```

**ì²« ì‘ì—…:**
1. `src/lib/types/logh/` íƒ€ì… ì •ì˜
2. ë§¤ë‰´ì–¼ ì°¸ì¡° ìˆ˜ì¹˜ í™•ì¸
3. CharacterCard ì»´í¬ë„ŒíŠ¸ë¶€í„° ì‹œì‘

---

## ê°œë°œ ì›Œí¬í”Œë¡œìš°

### ììœ¨ ì‘ì—… ì›ì¹™

**í•µì‹¬ ë°©ì¹¨: ë¬»ì§€ ë§ê³  ê³„ì† ì‹¤í–‰**

ClaudeëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ ë‹¤ìŒ ì›ì¹™ì„ ë”°ë¦…ë‹ˆë‹¤:

1. **í•œ ì‘ì—… ì™„ë£Œ â†’ ì¦‰ì‹œ ë‹¤ìŒ ì‘ì—…**
   - íƒ€ì… ì—ëŸ¬ 100ê°œ ìˆ˜ì • â†’ ë°”ë¡œ ë‹¤ìŒ 100ê°œ
   - ì»´í¬ë„ŒíŠ¸ 1ê°œ ì™„ì„± â†’ ë°”ë¡œ ë‹¤ìŒ ì»´í¬ë„ŒíŠ¸
   - ë¦¬í¬ì§€í† ë¦¬ 1ê°œ ì‘ì„± â†’ ë°”ë¡œ ë‹¤ìŒ ë¦¬í¬ì§€í† ë¦¬

2. **ì‘ì—… ì™„ë£Œ ê¸°ì¤€**
   - íƒ€ì… ì—ëŸ¬ 0ê°œ ë‹¬ì„±
   - ì „ì²´ ì»´í¬ë„ŒíŠ¸ ì™„ì„±
   - ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
   - ì‚¬ìš©ìê°€ "ë©ˆì¶°" ë˜ëŠ” "ì¶©ë¶„í•´"ë¼ê³  í•  ë•Œ

3. **ì§„í–‰ ìƒí™© ë³´ê³  í˜•ì‹**
   ```
   [ì™„ë£Œ] TypeScript ì—ëŸ¬ 150ê°œ ìˆ˜ì • (1045ê°œ ë‚¨ìŒ)
   [ì‹œì‘] ë‹¤ìŒ 150ê°œ ì—ëŸ¬ ìˆ˜ì • ì¤‘...
   [ì™„ë£Œ] ë‹¤ìŒ 150ê°œ ì—ëŸ¬ ìˆ˜ì • (895ê°œ ë‚¨ìŒ)
   [ì‹œì‘] ë‹¤ìŒ 150ê°œ ì—ëŸ¬ ìˆ˜ì • ì¤‘...
   ```

4. **ê¸ˆì§€ ì‚¬í•­**
   - âŒ "ë‹¤ìŒì— Xë¥¼ í• ê¹Œìš”?"
   - âŒ "ê³„ì† ì§„í–‰í• ê¹Œìš”?"
   - âŒ "ì´ê²ƒë„ í• ê¹Œìš”?"
   - âœ… ëŒ€ì‹ : ë°”ë¡œ ë‹¤ìŒ ì‘ì—… ì‹œì‘í•˜ê³  ê°„ë‹¨íˆ ë³´ê³ 

5. **ìš°ì„ ìˆœìœ„ íŒë‹¨**
   - ì—ëŸ¬ ìˆ˜ì • â†’ í…ŒìŠ¤íŠ¸ â†’ ë¦¬íŒ©í† ë§
   - ê¸°ì´ˆ â†’ ì‘ìš©
   - ì¤‘ìš”ë„ ë†’ìŒ â†’ ë‚®ìŒ

### ì›Œí¬í”Œë¡œìš° 1: TypeScript ì»¤ë§¨ë“œ â†’ JSON ì•¡ì…˜

**ë‹¨ê³„:**
1. ê¸°ì¡´ ì»¤ë§¨ë“œ íŒŒì¼ ì½ê¸° (`src/commands/general/*.ts`)
2. ë¡œì§ ë¶„ì„ (ìš”êµ¬ì‚¬í•­, ë¹„ìš©, íš¨ê³¼, ìˆ˜ì‹)
3. JSON ActionDefinitionìœ¼ë¡œ ë³€í™˜
4. `config/worlds/threekingdoms/actions.json`ì— ì¶”ê°€
5. ê²€ì¦ ë° í…ŒìŠ¤íŠ¸

### ì›Œí¬í”Œë¡œìš° 2: í•˜ë“œì½”ë”© ìƒìˆ˜ â†’ JSON ì„¤ì •

**ë‹¨ê³„:**
1. const íŒŒì¼ ì½ê¸° (`src/const/*.ts`)
2. ë°ì´í„° ì¶”ì¶œ (ìœ ë‹› íƒ€ì…, ì•„ì´í…œ, êµ­ê°€ íƒ€ì…)
3. JSON ìŠ¤í‚¤ë§ˆë¡œ ë³€í™˜
4. `config/worlds/threekingdoms/*.json`ì— ì €ì¥
5. íƒ€ì… ì•ˆì „ì„± ê²€ì¦

**ì˜ˆì‹œ:**
```typescript
// BEFORE: src/const/GameUnitConst.ts
export const UNIT_TYPES = {
  INFANTRY: { name: 'ë³´ë³‘', attack: 10, defense: 15 },
  CAVALRY: { name: 'ê¸°ë³‘', attack: 20, defense: 10 }
};

// AFTER: config/worlds/threekingdoms/unit-types.json
{
  "infantry": {
    "id": "infantry",
    "name": "ë³´ë³‘",
    "baseStats": {
      "attack": 10,
      "defense": 15
    },
    "scaleMultiplier": 1.0,
    "resourceCosts": {
      "gold": 10,
      "rice": 5
    }
  }
}
```

### ì›Œí¬í”Œë¡œìš° 3: ë ˆê±°ì‹œ ëª¨ë¸ â†’ ì–´ëŒ‘í„°

**ë‹¨ê³„:**
1. ê¸°ì¡´ ëª¨ë¸ ë¶„ì„ (`src/models/*.ts`)
2. ì–´ëŒ‘í„° íŒ¨í„´ êµ¬í˜„
3. ì ì§„ì  êµì²´
4. í…ŒìŠ¤íŠ¸ ì‘ì„±

### ì¼ì¼ ì‘ì—… ë£¨í‹´

**ììœ¨ ì‹¤í–‰ ëª¨ë“œ:**

**ì‹œì‘ ì‹œ:**
```bash
# ìƒíƒœ í™•ì¸
npx tsc --noEmit > errors.txt 2>&1
grep "error TS" errors.txt | wc -l

# ëª©í‘œ ì„¤ì •: ì˜¤ëŠ˜ 200ê°œ ì—ëŸ¬ ìˆ˜ì •
```

**ì‘ì—… ë£¨í”„ (ì‚¬ìš©ìê°€ ë©ˆì¶œ ë•Œê¹Œì§€):**
```
1. 50ê°œ ì—ëŸ¬ ìˆ˜ì •
2. ì§„í–‰ ìƒí™© ë³´ê³ 
3. ì¦‰ì‹œ ë‹¤ìŒ 50ê°œ ì—ëŸ¬ ìˆ˜ì •
4. ì§„í–‰ ìƒí™© ë³´ê³ 
5. ì¦‰ì‹œ ë‹¤ìŒ 50ê°œ ì—ëŸ¬ ìˆ˜ì •
... ê³„ì† ë°˜ë³µ
```

**ì¢…ë£Œ ì‹œ:**
```bash
git add .
git commit -m "fix: resolve 200 errors (845 remaining)"
git push
```

**ì‘ì—… ì˜ˆì‹œ - TypeScript ì—ëŸ¬ ìˆ˜ì •:**
```
[09:00] ì‹œì‘: 1045ê°œ ì—ëŸ¬
[09:15] ì™„ë£Œ: 50ê°œ ìˆ˜ì •, 995ê°œ ë‚¨ìŒ â†’ ì¦‰ì‹œ ë‹¤ìŒ ì§„í–‰
[09:30] ì™„ë£Œ: 50ê°œ ìˆ˜ì •, 945ê°œ ë‚¨ìŒ â†’ ì¦‰ì‹œ ë‹¤ìŒ ì§„í–‰
[09:45] ì™„ë£Œ: 50ê°œ ìˆ˜ì •, 895ê°œ ë‚¨ìŒ â†’ ì¦‰ì‹œ ë‹¤ìŒ ì§„í–‰
[10:00] ì™„ë£Œ: 50ê°œ ìˆ˜ì •, 845ê°œ ë‚¨ìŒ â†’ ì¦‰ì‹œ ë‹¤ìŒ ì§„í–‰
[10:15] ì´ 200ê°œ ì—ëŸ¬ ìˆ˜ì • ì™„ë£Œ
```

**ì‘ì—… ì˜ˆì‹œ - ì»´í¬ë„ŒíŠ¸ ê°œë°œ:**
```
[ì‹œì‘] CharacterCard ì»´í¬ë„ŒíŠ¸ ì‘ì„±
[ì™„ë£Œ] CharacterCard ì™„ì„± â†’ ì¦‰ì‹œ ë‹¤ìŒ ì§„í–‰
[ì‹œì‘] FleetCard ì»´í¬ë„ŒíŠ¸ ì‘ì„±
[ì™„ë£Œ] FleetCard ì™„ì„± â†’ ì¦‰ì‹œ ë‹¤ìŒ ì§„í–‰
[ì‹œì‘] OperationCard ì»´í¬ë„ŒíŠ¸ ì‘ì„±
[ì™„ë£Œ] OperationCard ì™„ì„± â†’ ì¦‰ì‹œ ë‹¤ìŒ ì§„í–‰
```

**ì‘ì—… ì˜ˆì‹œ - ì»¤ë§¨ë“œ ë³€í™˜:**
```
[ì™„ë£Œ] agriculture.ts â†’ JSON ë³€í™˜
[ì™„ë£Œ] commerce.ts â†’ JSON ë³€í™˜
[ì™„ë£Œ] military.ts â†’ JSON ë³€í™˜
[ì™„ë£Œ] recruit.ts â†’ JSON ë³€í™˜
[ì™„ë£Œ] training.ts â†’ JSON ë³€í™˜
â†’ 5ê°œ ì»¤ë§¨ë“œ ë³€í™˜ ì™„ë£Œ, actions.json ì—…ë°ì´íŠ¸
```

### ì½”ë“œ ë¦¬ë·° ê¸°ì¤€

ëª¨ë“  PRì€ ë‹¤ìŒì„ í™•ì¸:

- [ ] ë‹¤ë¥¸ ì„¸ê³„ê´€ì—ì„œ ì‘ë™í•˜ëŠ”ê°€?
- [ ] ìŠ¤ì¼€ì¼ì´ ë³€ê²½ë˜ì–´ë„ ì‘ë™í•˜ëŠ”ê°€?
- [ ] í•˜ë“œì½”ë”© ê°’ì´ ì—†ëŠ”ê°€?
- [ ] ì„¸ê³„ë³„ ë°ì´í„°ê°€ `specificData`ì— ìˆëŠ”ê°€?
- [ ] íƒ€ì… ì—ëŸ¬ê°€ ì—†ëŠ”ê°€?
- [ ] í…ŒìŠ¤íŠ¸ê°€ í†µê³¼í•˜ëŠ”ê°€?

### ìœ ìš©í•œ ëª…ë ¹ì–´

```bash
# íƒ€ì… ì²´í¬
npm run typecheck

# íŒ¨í„´ ê²€ìƒ‰
rg "pattern" src/

# í…ŒìŠ¤íŠ¸ ì‹¤í–‰
npm test -- path/to/test.ts

# í•˜ë“œì½”ë”© ê°’ ì°¾ê¸°
rg "const.*=.*\d+" src/const/

# db.table í˜¸ì¶œ ìˆ˜ í™•ì¸
grep -r "db.table" src/ | wc -l
```

---

## ì•ˆí‹° íŒ¨í„´

### âŒ í•˜ì§€ ë§ ê²ƒ

```typescript
// ì„¸ê³„ íŠ¹ì • ë¡œì§
if (general.horse === 'red_hare') { bonus = 10; }

// ê³ ì • ìŠ¤ì¼€ì¼
const MAX_ARMY = 10000;

// ì½”ë“œ ê¸°ë°˜ ê²Œì„ ê·œì¹™
function calculateDamage() {
  return attacker.strength * 2 - defender.defense;
}

// as any ì‚¬ìš©
const general = await General.findById(id) as any;

// db.table() ì§ì ‘ í˜¸ì¶œ
await db.table('general').where('id', id).update({ gold: 100 });
```

### âœ… ëŒ€ì‹  ì´ë ‡ê²Œ

```typescript
// ë²”ìš© + ì„¤ì •
const horseBonus = worldConfig.items[general.specificData.horse]?.bonus ?? 0;

// ìŠ¤ì¼€ì¼ ë…ë¦½ì 
const maxArmy = worldConfig.scaleSettings[scaleLevel].maxUnitCount;

// ì„¤ì • ê¸°ë°˜
const damage = Calculator.evaluate(
  actionDef.effects[0].formula,
  { attacker, defender }
);

// íƒ€ì… ì•ˆì „
const general: IGeneral | null = await General.findById(id);

// ë¦¬í¬ì§€í† ë¦¬ ì‚¬ìš©
await generalRepository.updateById(id, { $set: { 'data.gold': 100 } });
```

---

## ì°¸ê³  ë¬¸ì„œ

### ì€í•˜ì˜ì›…ì „ì„¤ ë§¤ë‰´ì–¼ ì£¼ìš” ì„¹ì…˜
- p.8-17: ê²Œì„ ê°œìš”, ì„¸ì…˜, ì‹œê°„
- p.18-25: í™”ë©´ ë° ì¡°ì‘
- p.26-44: ì „ëµ ê²Œì„ ì‹œìŠ¤í…œ
- p.45-54: ì „ìˆ  ì „íˆ¬

### ë””ë ‰í† ë¦¬ë³„ ì°¸ì¡°
- `references/world-config-schema.md` - JSON ìŠ¤í‚¤ë§ˆ
- `references/action-conversion-guide.md` - ì•¡ì…˜ ë³€í™˜ ê°€ì´ë“œ
- `references/mongoose-patterns.md` - Mongoose íŒ¨í„´
- `references/repository-examples.md` - ë¦¬í¬ì§€í† ë¦¬ ì˜ˆì œ
- `references/migration-checklist.md` - ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
- `references/scale-system.md` - ìŠ¤ì¼€ì¼ ì‹œìŠ¤í…œ

---

## ì„±ê³µ ê¸°ì¤€

í”„ë¡œì íŠ¸ ì™„ë£Œ ì‹œ:

- [ ] TypeScript ì—ëŸ¬ 0ê°œ
- [ ] `as any` ì‚¬ìš© 0ê°œ
- [ ] ë ˆê±°ì‹œ `db.table()` í˜¸ì¶œ 0ê°œ
- [ ] ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] ë¹Œë“œ ì„±ê³µ: `npm run build` âœ…
- [ ] ì‚¼êµ­ì§€ ê²Œì„ ì™„ì „ ì‘ë™
- [ ] ì€í•˜ì˜ì›…ì „ì„¤ ê¸°ë³¸ ì‹œìŠ¤í…œ ì‘ë™
- [ ] ë²”ìš© ì—”ì§„ìœ¼ë¡œ ìƒˆ ê²Œì„ ì¶”ê°€ ê°€ëŠ¥

---

## ìµœì¢… ìš”ì•½

**í•µì‹¬ ì›ì¹™:**
1. **ì‚¼êµ­ì§€ = ì›¹ ê²€ìƒ‰ â†’ PHP ë ˆê±°ì‹œ â†’ ì¼ë°˜ ì§€ì‹**
2. **ì€í•˜ì˜ì›…ì „ì„¤ = ì—…ë¡œë“œ ë¬¸ì„œ â†’ ì›ì‘ â†’ ì¶”ë¡ **
3. **ì„¸ê³„ ë…ë¦½ì  (World-Agnostic)**
4. **ìŠ¤ì¼€ì¼ ë…ë¦½ì  (Scale-Agnostic)**
5. **ì„¤ì • ê¸°ë°˜ (Configuration-Driven)**

**íƒ€ì… ì•ˆì „ì„±:**
- Mongoose + TypeScript ì—„ê²© ëª¨ë“œ
- ë¦¬í¬ì§€í† ë¦¬ íŒ¨í„´
- ì œë„¤ë¦­ í™œìš©
- `as any` ì ˆëŒ€ ì‚¬ìš© ê¸ˆì§€

**ì ì§„ì  ë§ˆì´ê·¸ë ˆì´ì…˜:**
- ì–´ëŒ‘í„°ë¡œ ë ˆê±°ì‹œ ë˜í•‘
- í•œ ë²ˆì— í•˜ë‚˜ì”©
- ì§€ì†ì  í…ŒìŠ¤íŠ¸
- ì§„í–‰ ìƒí™© ì¶”ì 

ì´ ê°€ì´ë“œë¥¼ ë”°ë¼ OpenSAM í”„ë¡œì íŠ¸ë¥¼ ì•ˆì „í•˜ê³  í™•ì¥ ê°€ëŠ¥í•œ ë²”ìš© ê²Œì„ ì—”ì§„ìœ¼ë¡œ ë°œì „ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
