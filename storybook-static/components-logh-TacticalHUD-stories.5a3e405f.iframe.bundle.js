/*! For license information please see components-logh-TacticalHUD-stories.5a3e405f.iframe.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkopen_sam_front=self.webpackChunkopen_sam_front||[]).push([[547,827],{"./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js":(__unused_webpack_module,exports,__webpack_require__)=>{var React=__webpack_require__("./node_modules/react/index.js");var objectIs="function"==typeof Object.is?Object.is:function is(x,y){return x===y&&(0!==x||1/x==1/y)||x!=x&&y!=y},useState=React.useState,useEffect=React.useEffect,useLayoutEffect=React.useLayoutEffect,useDebugValue=React.useDebugValue;function checkIfSnapshotChanged(inst){var latestGetSnapshot=inst.getSnapshot;inst=inst.value;try{var nextValue=latestGetSnapshot();return!objectIs(inst,nextValue)}catch(error){return!0}}var shim="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function useSyncExternalStore$1(subscribe,getSnapshot){return getSnapshot()}:function useSyncExternalStore$2(subscribe,getSnapshot){var value=getSnapshot(),_useState=useState({inst:{value,getSnapshot}}),inst=_useState[0].inst,forceUpdate=_useState[1];return useLayoutEffect(function(){inst.value=value,inst.getSnapshot=getSnapshot,checkIfSnapshotChanged(inst)&&forceUpdate({inst})},[subscribe,value,getSnapshot]),useEffect(function(){return checkIfSnapshotChanged(inst)&&forceUpdate({inst}),subscribe(function(){checkIfSnapshotChanged(inst)&&forceUpdate({inst})})},[subscribe]),useDebugValue(value),value};exports.useSyncExternalStore=void 0!==React.useSyncExternalStore?React.useSyncExternalStore:shim},"./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js":(__unused_webpack_module,exports,__webpack_require__)=>{var React=__webpack_require__("./node_modules/react/index.js"),shim=__webpack_require__("./node_modules/use-sync-external-store/shim/index.js");var objectIs="function"==typeof Object.is?Object.is:function is(x,y){return x===y&&(0!==x||1/x==1/y)||x!=x&&y!=y},useSyncExternalStore=shim.useSyncExternalStore,useRef=React.useRef,useEffect=React.useEffect,useMemo=React.useMemo,useDebugValue=React.useDebugValue;exports.useSyncExternalStoreWithSelector=function(subscribe,getSnapshot,getServerSnapshot,selector,isEqual){var instRef=useRef(null);if(null===instRef.current){var inst={hasValue:!1,value:null};instRef.current=inst}else inst=instRef.current;instRef=useMemo(function(){function memoizedSelector(nextSnapshot){if(!hasMemo){if(hasMemo=!0,memoizedSnapshot=nextSnapshot,nextSnapshot=selector(nextSnapshot),void 0!==isEqual&&inst.hasValue){var currentSelection=inst.value;if(isEqual(currentSelection,nextSnapshot))return memoizedSelection=currentSelection}return memoizedSelection=nextSnapshot}if(currentSelection=memoizedSelection,objectIs(memoizedSnapshot,nextSnapshot))return currentSelection;var nextSelection=selector(nextSnapshot);return void 0!==isEqual&&isEqual(currentSelection,nextSelection)?(memoizedSnapshot=nextSnapshot,currentSelection):(memoizedSnapshot=nextSnapshot,memoizedSelection=nextSelection)}var memoizedSnapshot,memoizedSelection,hasMemo=!1,maybeGetServerSnapshot=void 0===getServerSnapshot?null:getServerSnapshot;return[function(){return memoizedSelector(getSnapshot())},null===maybeGetServerSnapshot?void 0:function(){return memoizedSelector(maybeGetServerSnapshot())}]},[getSnapshot,getServerSnapshot,selector,isEqual]);var value=useSyncExternalStore(subscribe,instRef[0],instRef[1]);return useEffect(function(){inst.hasValue=!0,inst.value=value},[value]),useDebugValue(value),value}},"./node_modules/use-sync-external-store/shim/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.js")},"./node_modules/use-sync-external-store/shim/with-selector.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.js")},"./node_modules/zustand/esm/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{vt:()=>create});const createStoreImpl=createState=>{let state;const listeners=new Set,setState=(partial,replace)=>{const nextState="function"==typeof partial?partial(state):partial;if(!Object.is(nextState,state)){const previousState=state;state=(null!=replace?replace:"object"!=typeof nextState||null===nextState)?nextState:Object.assign({},state,nextState),listeners.forEach(listener=>listener(state,previousState))}},getState=()=>state,api={setState,getState,getInitialState:()=>initialState,subscribe:listener=>(listeners.add(listener),()=>listeners.delete(listener)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),listeners.clear()}},initialState=state=createState(setState,getState,api);return api},createStore=createState=>createState?createStoreImpl(createState):createStoreImpl;var react=__webpack_require__("./node_modules/react/index.js"),with_selector=__webpack_require__("./node_modules/use-sync-external-store/shim/with-selector.js");const{useDebugValue}=react,{useSyncExternalStoreWithSelector}=with_selector;let didWarnAboutEqualityFn=!1;const identity=arg=>arg;const createImpl=createState=>{"function"!=typeof createState&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const api="function"==typeof createState?createStore(createState):createState,useBoundStore=(selector,equalityFn)=>function useStore(api,selector=identity,equalityFn){equalityFn&&!didWarnAboutEqualityFn&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),didWarnAboutEqualityFn=!0);const slice=useSyncExternalStoreWithSelector(api.subscribe,api.getState,api.getServerState||api.getInitialState,selector,equalityFn);return useDebugValue(slice),slice}(api,selector,equalityFn);return Object.assign(useBoundStore,api),useBoundStore},create=createState=>createState?createImpl(createState):createImpl},"./src/components/logh/TacticalHUD.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>TacticalHUD_stories});var react=__webpack_require__("./node_modules/react/index.js"),gameStore=__webpack_require__("./src/stores/gameStore.ts"),logh=__webpack_require__("./src/lib/api/logh.ts");const COMMON_TEXT_unknown="ë¯¸í™•ì¸",LOGH_TEXT={radarActive:"ë ˆì´ë” ìž‘ë™ ì¤‘",autoResolveConfirm:"í•¨ëŒ€ AIë¥¼ í™œì„±í™”í• ê¹Œìš”? ì „íˆ¬ê°€ ìžë™ìœ¼ë¡œ ì²˜ë¦¬ë©ë‹ˆë‹¤.",autoResolveSuccess:winner=>`ì „íˆ¬ê°€ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ìŠ¹ìž: ${winner??COMMON_TEXT_unknown}`,autoResolveError:"ìžë™ ì²˜ë¦¬ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ìž ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.",autoResolveIdleLabel:"âš¡ ì „íˆ¬ ìžë™ ì²˜ë¦¬",autoResolveActiveLabel:"ðŸ¤– AI ìžë™ ì¡°ì¢… ì¤‘",shortcuts:["F: ì´ë™ ëª…ë ¹","R: ê³µê²© ëª…ë ¹","Z: ì²™ì¶” ì§„í˜•","X: ì˜¤ëª© ì§„í˜•"],pointerGuide:{leftClick:{label:"ì¢Œí´ë¦­",action:"í•¨ëŒ€ ì„ íƒ"},rightClick:{label:"ìš°í´ë¦­",action:"ì´ë™ ëª…ë ¹"},wheel:{label:"ìŠ¤í¬ë¡¤ íœ ",action:"í™•ëŒ€/ì¶•ì†Œ"}},positionLabel:"ì¢Œí‘œ",zoomPrefix:"í™•ëŒ€ìœ¨"};function TacticalHUD_TacticalHUD({battleId,sessionId="test_session",offlineStatus}){const{selectUnit,selectedUnitId}=(0,gameStore.T)(),[isAuto,setIsAuto]=(0,react.useState)(!1),[casualtyReport,setCasualtyReport]=(0,react.useState)([]),[showCasualties,setShowCasualties]=(0,react.useState)(!1);(0,react.useEffect)(()=>{offlineStatus?.hasOfflineCommanders&&!isAuto&&console.log("ì˜¤í”„ë¼ì¸ ì§€íœ˜ê´€ ê°ì§€ë¨, AI ìžë™ ì¡°ì¢… ì¶”ì²œ")},[offlineStatus,isAuto]);return(0,react.useEffect)(()=>{const handleKeyDown=e=>{switch(e.key.toLowerCase()){case"f":console.log("ëª…ë ¹: ì´ë™");break;case"r":console.log("ëª…ë ¹: ê³µê²©");break;case"z":console.log("ì§„í˜•: ì²™ì¶”");break;case"x":console.log("ì§„í˜•: ì˜¤ëª©");break;case"escape":selectUnit(null)}};return window.addEventListener("keydown",handleKeyDown),()=>window.removeEventListener("keydown",handleKeyDown)},[selectUnit]),React.createElement("div",{"data-testid":"logh-tactical-hud"},React.createElement("div",{"data-testid":"tactical-hud",className:"absolute top-4 right-4 w-48 h-48 bg-[#050510]/80 border border-[#1E90FF] rounded-full overflow-hidden pointer-events-auto shadow-lg backdrop-blur"},React.createElement("div",{className:"w-full h-full relative"},React.createElement("div",{className:"absolute inset-0 border-r border-[#1E90FF]/50 w-1/2 h-full origin-right animate-spin-slow",style:{animationDuration:"4s"}}),React.createElement("div",{className:"absolute top-1/2 left-1/2 w-2 h-2 bg-[#00FF00] -translate-x-1/2 -translate-y-1/2 rounded-full"}),React.createElement("div",{className:"absolute inset-0 border border-[#1E90FF]/20 rounded-full scale-50"}),React.createElement("div",{className:"absolute inset-0 border border-[#1E90FF]/20 rounded-full scale-75"})),React.createElement("div",{className:"absolute bottom-1 right-2 text-[10px] text-[#1E90FF] font-mono"},LOGH_TEXT.radarActive)),offlineStatus?.hasOfflineCommanders&&!isAuto&&React.createElement("div",{className:"absolute top-4 left-4 bg-orange-900/90 border border-orange-500 rounded-lg p-3 pointer-events-auto shadow-lg max-w-xs"},React.createElement("div",{className:"text-orange-300 font-bold text-sm mb-1"},"âš ï¸ ì˜¤í”„ë¼ì¸ ì§€íœ˜ê´€ ê°ì§€"),React.createElement("div",{className:"text-orange-200 text-xs"},offlineStatus.offlineCommanderIds.length,"ëª…ì˜ ì§€íœ˜ê´€ì´ ì˜¤í”„ë¼ì¸ ìƒíƒœìž…ë‹ˆë‹¤. AI ìžë™ ì¡°ì¢…ì„ ê¶Œìž¥í•©ë‹ˆë‹¤.")),showCasualties&&casualtyReport.length>0&&React.createElement("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-black/95 border-2 border-red-500 rounded-lg p-6 pointer-events-auto shadow-2xl min-w-[400px]"},React.createElement("div",{className:"text-red-400 font-bold text-lg mb-4 text-center"},"ðŸ“Š ì „íˆ¬ ì†ì‹¤ ë³´ê³ ì„œ"),React.createElement("div",{className:"space-y-3"},casualtyReport.map((report,idx)=>React.createElement("div",{key:idx,className:"bg-red-900/20 border border-red-700 rounded p-3"},React.createElement("div",{className:"text-white font-bold mb-2"},report.faction),React.createElement("div",{className:"text-sm text-gray-300 space-y-1"},React.createElement("div",null,"í•¨ì„  ì†ì‹¤: ",React.createElement("span",{className:"text-red-400 font-mono"},report.shipsLost.toLocaleString())),React.createElement("div",null,"ë³‘ë ¥ ì†ì‹¤: ",React.createElement("span",{className:"text-red-400 font-mono"},report.troopsLost.toLocaleString())))))),React.createElement("button",{onClick:()=>setShowCasualties(!1),className:"mt-4 w-full bg-red-600 hover:bg-red-700 text-white font-bold py-2 rounded"},"í™•ì¸")),React.createElement("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2 pointer-events-auto"},React.createElement("button",{onClick:async()=>{const confirmMessage=offlineStatus?.hasOfflineCommanders?`ì˜¤í”„ë¼ì¸ ì§€íœ˜ê´€ ${offlineStatus.offlineCommanderIds.length}ëª… ê°ì§€ë¨.\n`+LOGH_TEXT.autoResolveConfirm:LOGH_TEXT.autoResolveConfirm;if(confirm(confirmMessage))try{setIsAuto(!0);const result=await logh.loghApi.autoResolveBattle(battleId,"temp-resolver-id");result.data?.casualtyReport&&(setCasualtyReport(result.data.casualtyReport),setShowCasualties(!0)),alert(LOGH_TEXT.autoResolveSuccess(result.data?.factions?.[0]?.code||null))}catch(e){alert(LOGH_TEXT.autoResolveError),setIsAuto(!1)}},disabled:isAuto,className:"px-3 py-1 border rounded text-xs font-bold transition-all "+(offlineStatus?.hasOfflineCommanders&&!isAuto?"bg-orange-500/30 border-orange-500 text-orange-300 animate-pulse hover:bg-orange-500/50":isAuto?"bg-yellow-500/20 border-yellow-500 text-yellow-500":"bg-black/60 border-white/30 text-white hover:bg-white/10")},isAuto?LOGH_TEXT.autoResolveActiveLabel:LOGH_TEXT.autoResolveIdleLabel),LOGH_TEXT.shortcuts.map(cmd=>React.createElement("div",{key:cmd,className:"bg-black/60 text-[#9CA3AF] text-xs px-2 py-1 border border-[#333] rounded"},cmd))))}try{TacticalHUD_TacticalHUD.displayName="TacticalHUD",TacticalHUD_TacticalHUD.__docgenInfo={description:"",displayName:"TacticalHUD",props:{battleId:{defaultValue:null,description:"",name:"battleId",required:!0,type:{name:"string"}},sessionId:{defaultValue:{value:"test_session"},description:"",name:"sessionId",required:!1,type:{name:"string | undefined"}},offlineStatus:{defaultValue:null,description:"",name:"offlineStatus",required:!1,type:{name:"{ hasOfflineCommanders: boolean; offlineCommanderIds: string[]; } | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/logh/TacticalHUD.tsx#TacticalHUD"]={docgenInfo:TacticalHUD_TacticalHUD.__docgenInfo,name:"TacticalHUD",path:"src/components/logh/TacticalHUD.tsx#TacticalHUD"})}catch(__react_docgen_typescript_loader_error){}const TacticalHUD_stories={title:"Logh/TacticalHUD",component:TacticalHUD_TacticalHUD,parameters:{layout:"fullscreen"},decorators:[Story=>React.createElement("div",{className:"w-screen h-screen bg-[#050510]"},React.createElement(Story,null))]},Default={args:{battleId:"test-battle-1"}},__namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"{\n  args: {\n    battleId: 'test-battle-1'\n  }\n}",...Default.parameters?.docs?.source}}};try{TacticalHUD.displayName="TacticalHUD",TacticalHUD.__docgenInfo={description:"",displayName:"TacticalHUD",props:{battleId:{defaultValue:null,description:"",name:"battleId",required:!0,type:{name:"string"}},sessionId:{defaultValue:{value:"test_session"},description:"",name:"sessionId",required:!1,type:{name:"string | undefined"}},offlineStatus:{defaultValue:null,description:"",name:"offlineStatus",required:!1,type:{name:"{ hasOfflineCommanders: boolean; offlineCommanderIds: string[]; } | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/logh/TacticalHUD.stories.tsx#TacticalHUD"]={docgenInfo:TacticalHUD.__docgenInfo,name:"TacticalHUD",path:"src/components/logh/TacticalHUD.stories.tsx#TacticalHUD"})}catch(__react_docgen_typescript_loader_error){}},"./src/lib/api/logh.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{loghApi:()=>loghApi});const API_BASE="/api/logh",fetchWithAuth=async(url,options={})=>{const headers={"Content-Type":"application/json",Authorization:"Bearer DEV-GALAXY-TOKEN",...options.headers},res=await fetch(url,{...options,headers});if(!res.ok){const error=await res.text().catch(()=>res.statusText);throw new Error(`API Error ${res.status}: ${error}`)}return res.json()},CMD_MAP={warp:"move_fleet",move:"move_fleet",attack:"issue_operation",supply:"issue_operation",personnel:"issue_operation",tactics:"issue_operation"},loghApi={getGalaxyViewport:async sessionId=>{const params=new URLSearchParams;sessionId&&params.set("sessionId",sessionId);const response=await fetch(`/api/gin7/state/strategy?${params.toString()}`);if(!response.ok)throw new Error("Failed to fetch galaxy viewport data");return response.json()},getGroundCombatState:async(battleId,sessionId)=>{const params=new URLSearchParams;sessionId&&params.set("sessionId",sessionId);const response=await fetch(`/api/logh/ground-combat/${battleId}?${params.toString()}`);if(!response.ok)throw new Error("Failed to fetch ground combat state");return response.json()},getOccupationStatus:async(battleId,sessionId)=>{const params=new URLSearchParams;sessionId&&params.set("sessionId",sessionId);const response=await fetch(`/api/logh/ground-combat/${battleId}/occupation?${params.toString()}`);if(!response.ok)throw new Error("Failed to fetch occupation status");return response.json()},getSupplyBatches:async(battleId,sessionId)=>{const params=new URLSearchParams;sessionId&&params.set("sessionId",sessionId);const response=await fetch(`/api/logh/ground-combat/${battleId}/supplies?${params.toString()}`);if(!response.ok)throw new Error("Failed to fetch supply batches");return response.json()},getWarehouseStocks:async(battleId,sessionId)=>{const params=new URLSearchParams;sessionId&&params.set("sessionId",sessionId);const response=await fetch(`/api/logh/ground-combat/${battleId}/warehouse?${params.toString()}`);if(!response.ok)throw new Error("Failed to fetch warehouse stocks");return response.json()},updateOccupation:async(battleId,planetId,updates,sessionId)=>{const response=await fetch(`/api/logh/ground-combat/${battleId}/occupation/${planetId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...updates,sessionId})});if(!response.ok)throw new Error("Failed to update occupation status");return response.json()},consumeSupply:async(battleId,batchId,amount,sessionId)=>{const response=await fetch(`/api/logh/ground-combat/${battleId}/supplies/${batchId}/consume`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount,sessionId})});if(!response.ok)throw new Error("Failed to consume supply");return response.json()},getUserProfile:async()=>{const data=await fetchWithAuth(`${API_BASE}/galaxy/commanders?my_character=true`);if(data.data&&data.data.length>0){const cmd=data.data[0];return{id:cmd.no.toString(),name:cmd.name,rank:cmd.rank,faction:cmd.faction,pcp:cmd.commandPoints?.personal||0,mcp:cmd.commandPoints?.military||0,maxPcp:100,maxMcp:100,jobCards:[]}}throw new Error("No commander found")},executeCommand:async(cardId,command,target)=>{const backendCmd=CMD_MAP[command],data=await fetchWithAuth(`${API_BASE}/command/execute`,{method:"POST",body:JSON.stringify({command:backendCmd,params:{target,cardId}})});return{success:data.success,message:data.message||"Command executed",pcpCost:0,mcpCost:0}},getEconomyState:async(sessionId,characterId)=>{const params=new URLSearchParams({sessionId});characterId&&params.set("characterId",characterId);return(await fetchWithAuth(`${API_BASE}/galaxy/economy/state?${params}`)).data},getEconomyEvents:async(sessionId,characterId,limit=10)=>{const params=new URLSearchParams({sessionId,limit:limit.toString()});characterId&&params.set("characterId",characterId);return(await fetchWithAuth(`${API_BASE}/galaxy/economy/events?${params}`)).data},getChatMessages:async(sessionId,channelType,scopeId,limit=50)=>{const params=new URLSearchParams({sessionId,channelType,limit:limit.toString()});scopeId&&params.append("scopeId",scopeId);return(await fetchWithAuth(`${API_BASE}/galaxy/comm/messages?${params}`)).data||[]},sendChatMessage:async(sessionId,channelType,senderCharacterId,message,scopeId,metadata)=>(await fetchWithAuth(`${API_BASE}/galaxy/comm/messages`,{method:"POST",body:JSON.stringify({sessionId,channelType,scopeId,senderCharacterId,message,metadata})})).data,getHandshakes:async(sessionId,characterId)=>{const params=new URLSearchParams({sessionId,characterId});return(await fetchWithAuth(`${API_BASE}/galaxy/comm/handshakes?${params}`)).data||[]},requestHandshake:async(sessionId,requesterCharacterId,targetCharacterId)=>(await fetchWithAuth(`${API_BASE}/galaxy/comm/handshakes`,{method:"POST",body:JSON.stringify({sessionId,requesterCharacterId,targetCharacterId})})).data,respondHandshake:async(sessionId,handshakeId,responderCharacterId,action)=>(await fetchWithAuth(`${API_BASE}/galaxy/comm/handshakes/${handshakeId}/respond`,{method:"POST",body:JSON.stringify({sessionId,responderCharacterId,action})})).data,getAddressBook:async(sessionId,characterId)=>{const params=new URLSearchParams({sessionId,characterId});return(await fetchWithAuth(`${API_BASE}/galaxy/comm/address-book?${params}`)).data||[]},addAddressBookEntry:async(sessionId,ownerCharacterId,contactCharacterId,contactName)=>(await fetchWithAuth(`${API_BASE}/galaxy/comm/address-book`,{method:"POST",body:JSON.stringify({sessionId,ownerCharacterId,contactCharacterId,contactName})})).data,autoResolveBattle:async(battleId,resolverCharacterId)=>fetchWithAuth(`${API_BASE}/galaxy/tactical-battles/${battleId}/resolve`,{method:"POST",body:JSON.stringify({autoResolve:!0,resolverCharacterId})}),checkOfflineCommanders:async(battleId,sessionId)=>{const params=new URLSearchParams;sessionId&&params.set("sessionId",sessionId);return(await fetchWithAuth(`${API_BASE}/galaxy/tactical-battles/${battleId}/offline-check?${params}`)).data||{hasOfflineCommanders:!1,offlineCommanderIds:[]}},getMyFleet:async()=>{try{const res=await fetchWithAuth(`${API_BASE}/fleet/my`);if(res.data)return res.data}catch(e){}return{id:"mock-fleet-1",commanderName:"Yang Wen-li",faction:"alliance",gridX:10,gridY:10,size:5e3,status:"idle",formation:"standard",morale:95,supplies:8e3,ammo:7500,ships:Array.from({length:20}).map((_,i)=>({id:`ship-${i}`,name:`Hyperion-${i}`,type:0===i?"battleship":i<5?"cruiser":"destroyer",durability:100,maxDurability:100,crew:100,maxCrew:100,energy:100,maxEnergy:100,status:"active"}))}},updateFormation:async formationId=>{try{return await fetchWithAuth(`${API_BASE}/fleet/formation`,{method:"POST",body:JSON.stringify({formation:formationId})}),!0}catch(e){return console.warn("API failed, using mock success"),!0}},getBattleState:async battleId=>{try{const res=await fetchWithAuth(`${API_BASE}/galaxy/tactical-battles/${battleId}`);if(res.data)return res.data}catch(e){}return{id:battleId,turn:1,phase:"planning",fleets:[{fleetId:"f1",name:"13th Fleet",faction:"alliance",totalShips:5e3,formation:"standard",tacticalPosition:{x:2e3,y:5e3,heading:0}},{fleetId:"f2",name:"Imperial Fleet",faction:"empire",totalShips:8e3,formation:"spindle",tacticalPosition:{x:8e3,y:5e3,heading:180}}]}}}},"./src/stores/gameStore.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>useGameStore});const useGameStore=(0,__webpack_require__("./node_modules/zustand/esm/index.mjs").vt)(set=>({gameState:{year:796,month:1,day:1,hour:12},userProfile:{id:"u1",name:"Yang Wen-li",rank:"Commodore",faction:"alliance",pcp:100,mcp:120,maxPcp:100,maxMcp:150,jobCards:[{id:"c1",title:"13th Fleet Commander",rankReq:"Rear Admiral",commands:["warp","attack","supply"]}]},viewport:{x:0,y:0,zoom:1},selectedGrid:null,selectedObject:null,selectedUnitId:null,starSystems:[],fleets:[],isLoadingGalaxy:!1,galaxyError:null,setViewport:(x,y,zoom)=>set(state=>({viewport:{...state.viewport,x,y,zoom:zoom??state.viewport.zoom}})),selectGrid:(x,y)=>set({selectedGrid:{x,y},selectedObject:null}),selectObject:(type,id)=>set({selectedObject:{type,id}}),selectUnit:id=>set({selectedUnitId:id}),refreshUserProfile:profile=>set({userProfile:profile}),updateCP:(pcpDelta,mcpDelta)=>set(state=>state.userProfile?{userProfile:{...state.userProfile,pcp:Math.max(0,state.userProfile.pcp+pcpDelta),mcp:Math.max(0,state.userProfile.mcp+mcpDelta)}}:state),loadGalaxyData:async sessionId=>{set({isLoadingGalaxy:!0,galaxyError:null});try{const{loghApi}=await __webpack_require__.e(827).then(__webpack_require__.bind(__webpack_require__,"./src/lib/api/logh.ts")),response=await loghApi.getGalaxyViewport(sessionId);if(!response.success||!response.data)throw new Error("Invalid galaxy data response");const data=response.data,starSystems=[];data.cells&&Array.isArray(data.cells)&&data.cells.forEach(cell=>{"star_system"===cell.type&&cell.label&&starSystems.push({id:`sys-${cell.x}-${cell.y}`,name:cell.label,gridX:cell.x,gridY:cell.y,faction:cell.faction||"none",planets:[]})});const fleets=[];data.fleets&&Array.isArray(data.fleets)&&data.fleets.forEach(fleet=>{fleets.push({id:fleet.id,commanderName:fleet.name||"Unknown",faction:fleet.faction||"none",gridX:fleet.x,gridY:fleet.y,size:fleet.cpLoad?.mcp||0,status:fleet.status||"idle"})});const newViewport=data.viewport?{x:data.viewport.x||0,y:data.viewport.y||0,zoom:1}:void 0;set({starSystems,fleets,isLoadingGalaxy:!1,...newViewport&&{viewport:newViewport}})}catch(error){console.error("Failed to load galaxy data:",error),set({galaxyError:error.message||"Failed to load galaxy data",isLoadingGalaxy:!1})}},loadMockData:()=>set({starSystems:[{id:"s1",name:"Astarte",gridX:5,gridY:5,faction:"alliance",planets:[{id:"p1",name:"Astarte IV",type:"planet",population:2e8}]},{id:"s2",name:"Odin",gridX:20,gridY:20,faction:"empire",planets:[{id:"p2",name:"Odin",type:"planet",population:25e8}]}],fleets:[{id:"f1",commanderName:"Yang Wen-li",faction:"alliance",gridX:5,gridY:5,size:15e3,status:"idle"},{id:"f2",commanderName:"Reinhard von Lohengramm",faction:"empire",gridX:6,gridY:5,size:2e4,status:"moving"}]})}));if("undefined"!=typeof window){const globalWindow=window;globalWindow.__OPEN_SAM_STORES__=globalWindow.__OPEN_SAM_STORES__??{},globalWindow.__OPEN_SAM_STORES__.game=useGameStore}}}]);